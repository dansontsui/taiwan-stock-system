<!DOCTYPE html>
<html lang='zh-Hant'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>2385 互動式回測分析</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #e9ecef;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .tab:hover {
            background: #dee2e6;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #667eea;
            color: #667eea;
        }
        .tab-content {
            display: none;
            padding: 30px;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }
        .model-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #dee2e6;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:hover {
            background: #f1f7ff;
        }
        .num {
            font-variant-numeric: tabular-nums;
        }
        .error-positive {
            color: #dc3545;
        }
        .error-negative {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>2385 互動式回測分析</h1>
            <p>所有模型的預測表現與詳細歷史</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">📊 總覽</button>
            <button class="tab" onclick="showTab('prophet')">📐 Prophet</button>
            <button class="tab" onclick="showTab('xgboost')">🌲 XGBoost</button>
        </div>

        <!-- 總覽頁面 -->
        <div id="overview" class="tab-content active">
            <h2>📈 所有模型預測對比</h2>
            <div class="chart-container">
                <div id="comparison-chart" style="height: 600px;"></div>
            </div>

            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">10.92%</div>
                    <div class="stat-label">Prophet MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">63.8%</div>
                    <div class="stat-label">Prophet 趨勢準確率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">17.82%</div>
                    <div class="stat-label">XGBoost MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">56.4%</div>
                    <div class="stat-label">XGBoost 趨勢準確率</div>
                </div>
            </div>
        </div>
        <div id="prophet" class="tab-content">
            <h2>📐 Prophet 詳細分析</h2>
            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">10.92%</div>
                    <div class="stat-label">MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">63.8%</div>
                    <div class="stat-label">趨勢準確率</div>
                </div>
            </div>
            <div class="chart-container">
                <div id="prophet-chart" style="height: 500px;"></div>
            </div>
            <h3>詳細回測歷史</h3>
            <div style="max-height: 400px; overflow: auto; border: 1px solid #eee;">
                <table>
                    <thead>
                        <tr>
                            <th>期數</th>
                            <th>回測年月</th>
                            <th>預測數據</th>
                            <th>實際數據</th>
                            <th>誤差(%)</th>
                        </tr>
                    </thead>
                    <tbody id="prophet-tbody"></tbody>
                </table>
            </div>
            <script>
                (function() {
                    const rows = [{"period": 1, "test_date": "2011-12", "predicted": 1280740619.4378948, "actual": 1779774000.0, "error_pct": 28.039143203693566}, {"period": 2, "test_date": "2012-01", "predicted": 1586046138.893268, "actual": 1248014000.0, "error_pct": 27.08560472024097}, {"period": 3, "test_date": "2012-02", "predicted": 561117522.9947714, "actual": 1361917000.0, "error_pct": 58.79943322575668}, {"period": 4, "test_date": "2012-03", "predicted": 1550915675.398681, "actual": 1455272000.0, "error_pct": 6.572219859839324}, {"period": 5, "test_date": "2012-04", "predicted": 2189730856.6111116, "actual": 1519363000.0, "error_pct": 44.12163891124844}, {"period": 6, "test_date": "2012-05", "predicted": 1735528927.1437817, "actual": 1635163000.0, "error_pct": 6.137976895501039}, {"period": 7, "test_date": "2012-06", "predicted": 1251628384.744397, "actual": 1632237000.0, "error_pct": 23.318220041305466}, {"period": 8, "test_date": "2012-07", "predicted": 1214009101.2922027, "actual": 1798759000.0, "error_pct": 32.508518301106335}, {"period": 9, "test_date": "2012-08", "predicted": 1504603006.7298121, "actual": 1987380000.0, "error_pct": 24.29213302288379}, {"period": 10, "test_date": "2012-09", "predicted": 2432611142.6988716, "actual": 2121336000.0, "error_pct": 14.673542649484647}, {"period": 11, "test_date": "2012-10", "predicted": 2473830693.2810225, "actual": 2408601000.0, "error_pct": 2.7081983807622163}, {"period": 12, "test_date": "2012-11", "predicted": 3062274700.326778, "actual": 2587932000.0, "error_pct": 18.329024886541763}, {"period": 13, "test_date": "2012-12", "predicted": 1907272847.3775158, "actual": 3586626000.0, "error_pct": 46.82264480942491}, {"period": 14, "test_date": "2013-01", "predicted": 2596088373.756127, "actual": 5873901000.0, "error_pct": 55.80299406210409}, {"period": 15, "test_date": "2013-02", "predicted": 4089811629.770335, "actual": 4721884000.0, "error_pct": 13.386020711852828}, {"period": 16, "test_date": "2013-03", "predicted": 5487930869.394059, "actual": 6597561000.0, "error_pct": 16.81879304497436}, {"period": 17, "test_date": "2013-04", "predicted": 7008195691.940132, "actual": 5754994000.0, "error_pct": 21.775899191904145}, {"period": 18, "test_date": "2013-05", "predicted": 5473472763.921561, "actual": 5941991000.0, "error_pct": 7.884869500449239}, {"period": 19, "test_date": "2013-06", "predicted": 5404032951.945535, "actual": 6131932000.0, "error_pct": 11.870631442985104}, {"period": 20, "test_date": "2013-07", "predicted": 6547586886.042964, "actual": 5700106000.0, "error_pct": 14.867809230968055}, {"period": 21, "test_date": "2013-08", "predicted": 5960005361.403139, "actual": 6083585000.0, "error_pct": 2.031362076750155}, {"period": 22, "test_date": "2013-09", "predicted": 6913589740.627511, "actual": 6682871000.0, "error_pct": 3.452389558731734}, {"period": 23, "test_date": "2013-10", "predicted": 6712247266.408046, "actual": 6512235000.0, "error_pct": 3.0713306016758573}, {"period": 24, "test_date": "2013-11", "predicted": 7219858689.388716, "actual": 7414867000.0, "error_pct": 2.629963701456604}, {"period": 25, "test_date": "2013-12", "predicted": 8746709403.501795, "actual": 7112682000.0, "error_pct": 22.97343538628319}, {"period": 26, "test_date": "2014-01", "predicted": 7840426104.700977, "actual": 5648668000.0, "error_pct": 38.80132634279404}, {"period": 27, "test_date": "2014-02", "predicted": 4974015730.262829, "actual": 4932419000.0, "error_pct": 0.843333266351233}, {"period": 28, "test_date": "2014-03", "predicted": 6576657337.195359, "actual": 6374006000.0, "error_pct": 3.179340232741532}, {"period": 29, "test_date": "2014-04", "predicted": 5298049540.001785, "actual": 6219679000.0, "error_pct": 14.817958611661709}, {"period": 30, "test_date": "2014-05", "predicted": 5905013577.161407, "actual": 6343006000.0, "error_pct": 6.905123892971132}, {"period": 31, "test_date": "2014-06", "predicted": 5924754510.556249, "actual": 6415313000.0, "error_pct": 7.646680519621589}, {"period": 32, "test_date": "2014-07", "predicted": 5664210071.961297, "actual": 6050206000.0, "error_pct": 6.379880751807508}, {"period": 33, "test_date": "2014-08", "predicted": 6069541751.394506, "actual": 6078635000.0, "error_pct": 0.14959359470495506}, {"period": 34, "test_date": "2014-09", "predicted": 7395098406.514104, "actual": 7866553000.0, "error_pct": 5.993153462334725}, {"period": 35, "test_date": "2014-10", "predicted": 6921761643.947831, "actual": 7680950000.0, "error_pct": 9.88404241730735}, {"period": 36, "test_date": "2014-11", "predicted": 8611496762.243128, "actual": 8123197000.0, "error_pct": 6.0111771540580365}, {"period": 37, "test_date": "2014-12", "predicted": 8159902772.663191, "actual": 8376832000.0, "error_pct": 2.5896332567826255}, {"period": 38, "test_date": "2015-01", "predicted": 5589062167.907922, "actual": 6668599000.0, "error_pct": 16.188360285152523}, {"period": 39, "test_date": "2015-02", "predicted": 5848616582.704639, "actual": 4898817000.0, "error_pct": 19.38834585379775}, {"period": 40, "test_date": "2015-03", "predicted": 7786653204.851375, "actual": 6438739000.0, "error_pct": 20.93444391598067}, {"period": 41, "test_date": "2015-04", "predicted": 7394023239.800808, "actual": 6253401000.0, "error_pct": 18.240030341902077}, {"period": 42, "test_date": "2015-05", "predicted": 7009343256.119253, "actual": 6806863000.0, "error_pct": 2.9746486174211695}, {"period": 43, "test_date": "2015-06", "predicted": 6896968794.082286, "actual": 7198514000.0, "error_pct": 4.18899242145968}, {"period": 44, "test_date": "2015-07", "predicted": 6191490616.907748, "actual": 6723583000.0, "error_pct": 7.9138218877085595}, {"period": 45, "test_date": "2015-08", "predicted": 5958444373.103093, "actual": 6793255000.0, "error_pct": 12.288816287580943}, {"period": 46, "test_date": "2015-09", "predicted": 8381802428.136128, "actual": 7517760000.0, "error_pct": 11.493349456967614}, {"period": 47, "test_date": "2015-10", "predicted": 7990806551.899401, "actual": 7036601000.0, "error_pct": 13.56060336374623}, {"period": 48, "test_date": "2015-11", "predicted": 9101922092.43867, "actual": 7360885000.0, "error_pct": 23.65255118696555}, {"period": 49, "test_date": "2015-12", "predicted": 9250285830.86511, "actual": 6976597000.0, "error_pct": 32.59022745423177}, {"period": 50, "test_date": "2016-01", "predicted": 5931538603.60922, "actual": 5600811000.0, "error_pct": 5.904994894653998}, {"period": 51, "test_date": "2016-02", "predicted": 4863103891.813024, "actual": 4592953000.0, "error_pct": 5.8818562221956885}, {"period": 52, "test_date": "2016-03", "predicted": 6310691212.880725, "actual": 6431429000.0, "error_pct": 1.8773088705367826}, {"period": 53, "test_date": "2016-04", "predicted": 5725313667.362301, "actual": 5287804000.0, "error_pct": 8.273938810180953}, {"period": 54, "test_date": "2016-05", "predicted": 5786212947.911183, "actual": 6051631000.0, "error_pct": 4.385892862417036}, {"period": 55, "test_date": "2016-06", "predicted": 5996811772.952022, "actual": 6921863000.0, "error_pct": 13.364194394601256}, {"period": 56, "test_date": "2016-07", "predicted": 5959222188.920571, "actual": 6219894000.0, "error_pct": 4.190936550999562}, {"period": 57, "test_date": "2016-08", "predicted": 6162095697.644727, "actual": 7055487000.0, "error_pct": 12.662361965308321}, {"period": 58, "test_date": "2016-09", "predicted": 7150707063.858178, "actual": 7699548000.0, "error_pct": 7.128222801414082}, {"period": 59, "test_date": "2016-10", "predicted": 6622971454.575463, "actual": 6754613000.0, "error_pct": 1.948913215672559}, {"period": 60, "test_date": "2016-11", "predicted": 6749571191.825383, "actual": 7216573000.0, "error_pct": 6.471240686883051}, {"period": 61, "test_date": "2016-12", "predicted": 6626120100.110046, "actual": 7180789000.0, "error_pct": 7.724344774508116}, {"period": 62, "test_date": "2017-01", "predicted": 6832208828.820733, "actual": 5143902000.0, "error_pct": 32.8215200993474}, {"period": 63, "test_date": "2017-02", "predicted": 5186716958.698482, "actual": 5203731000.0, "error_pct": 0.326958509221911}, {"period": 64, "test_date": "2017-03", "predicted": 6283133013.103116, "actual": 6594380000.0, "error_pct": 4.719882489284572}, {"period": 65, "test_date": "2017-04", "predicted": 5590352494.827552, "actual": 5405917000.0, "error_pct": 3.4117337507688674}, {"period": 66, "test_date": "2017-05", "predicted": 6018414022.774128, "actual": 6024573000.0, "error_pct": 0.10223093364246795}, {"period": 67, "test_date": "2017-06", "predicted": 6432253075.580138, "actual": 7239136000.0, "error_pct": 11.14612191869115}, {"period": 68, "test_date": "2017-07", "predicted": 6054215475.527834, "actual": 6159685000.0, "error_pct": 1.7122551635703136}, {"period": 69, "test_date": "2017-08", "predicted": 6530864583.391237, "actual": 7144632000.0, "error_pct": 8.590609237939235}, {"period": 70, "test_date": "2017-09", "predicted": 7507851798.469116, "actual": 8204632000.0, "error_pct": 8.49252229144322}, {"period": 71, "test_date": "2017-10", "predicted": 7067605982.820854, "actual": 7258777000.0, "error_pct": 2.6336532611367702}, {"period": 72, "test_date": "2017-11", "predicted": 7539652037.35254, "actual": 7168342000.0, "error_pct": 5.17985940615752}, {"period": 73, "test_date": "2017-12", "predicted": 7365305193.479966, "actual": 6608609000.0, "error_pct": 11.450158323483295}, {"period": 74, "test_date": "2018-01", "predicted": 6093464307.537715, "actual": 6296190000.0, "error_pct": 3.2198153559896547}, {"period": 75, "test_date": "2018-02", "predicted": 5174333298.306779, "actual": 4645242000.0, "error_pct": 11.389961993514632}, {"period": 76, "test_date": "2018-03", "predicted": 6642817945.205283, "actual": 6632412000.0, "error_pct": 0.15689533770343525}, {"period": 77, "test_date": "2018-04", "predicted": 6050009011.615663, "actual": 6429137000.0, "error_pct": 5.897027678587926}, {"period": 78, "test_date": "2018-05", "predicted": 6472788030.892595, "actual": 7380200000.0, "error_pct": 12.295221933110277}, {"period": 79, "test_date": "2018-06", "predicted": 6992148684.037953, "actual": 7452135000.0, "error_pct": 6.172544055657159}, {"period": 80, "test_date": "2018-07", "predicted": 6507217240.919819, "actual": 7721252000.0, "error_pct": 15.72328890548037}, {"period": 81, "test_date": "2018-08", "predicted": 7023588480.937802, "actual": 8669740000.0, "error_pct": 18.98732279240436}, {"period": 82, "test_date": "2018-09", "predicted": 8436342422.587008, "actual": 8584290000.0, "error_pct": 1.7234690045768668}, {"period": 83, "test_date": "2018-10", "predicted": 7998111991.34116, "actual": 8239915000.0, "error_pct": 2.9345328035403297}, {"period": 84, "test_date": "2018-11", "predicted": 8562171443.237794, "actual": 8165418000.0, "error_pct": 4.8589483506881574}, {"period": 85, "test_date": "2018-12", "predicted": 8384827094.034891, "actual": 7044474000.0, "error_pct": 19.02701456538687}, {"period": 86, "test_date": "2019-01", "predicted": 6848710190.62031, "actual": 7128216000.0, "error_pct": 3.9211186835484524}, {"period": 87, "test_date": "2019-02", "predicted": 5542594531.911112, "actual": 4954893000.0, "error_pct": 11.86103376825921}, {"period": 88, "test_date": "2019-03", "predicted": 7592702737.056445, "actual": 7094332000.0, "error_pct": 7.024914214001334}, {"period": 89, "test_date": "2019-04", "predicted": 7277166290.198002, "actual": 6751644000.0, "error_pct": 7.783619666528654}, {"period": 90, "test_date": "2019-05", "predicted": 7750505280.972808, "actual": 7990153000.0, "error_pct": 2.999288236748309}, {"period": 91, "test_date": "2019-06", "predicted": 7771521214.654314, "actual": 7809262000.0, "error_pct": 0.4832823555629963}, {"period": 92, "test_date": "2019-07", "predicted": 7544779654.102165, "actual": 8009584000.0, "error_pct": 5.803102207278615}, {"period": 93, "test_date": "2019-08", "predicted": 7824858233.841808, "actual": 9042891000.0, "error_pct": 13.469506224925102}, {"period": 94, "test_date": "2019-09", "predicted": 8935098621.154428, "actual": 9133066000.0, "error_pct": 2.16758949125706}, {"period": 95, "test_date": "2019-10", "predicted": 8815765609.066223, "actual": 9280205000.0, "error_pct": 5.004624261358201}, {"period": 96, "test_date": "2019-11", "predicted": 9336065634.879025, "actual": 8260309000.0, "error_pct": 13.023200886056738}, {"period": 97, "test_date": "2019-12", "predicted": 8829218909.140095, "actual": 7097768000.0, "error_pct": 24.394301266822115}, {"period": 98, "test_date": "2020-01", "predicted": 7520212117.619076, "actual": 6228700000.0, "error_pct": 20.73485827891977}, {"period": 99, "test_date": "2020-02", "predicted": 5664262591.073432, "actual": 4280190000.0, "error_pct": 32.33670914313224}, {"period": 100, "test_date": "2020-03", "predicted": 7742541395.990896, "actual": 7601329000.0, "error_pct": 1.8577329831519755}, {"period": 101, "test_date": "2020-04", "predicted": 6718333777.032738, "actual": 8891424000.0, "error_pct": 24.44029463635141}, {"period": 102, "test_date": "2020-05", "predicted": 7561129392.354336, "actual": 8190663000.0, "error_pct": 7.6859908367083865}, {"period": 103, "test_date": "2020-06", "predicted": 8911175013.115463, "actual": 8014033000.0, "error_pct": 11.194638368914418}, {"period": 104, "test_date": "2020-07", "predicted": 8087769830.057258, "actual": 8194616000.0, "error_pct": 1.303858166663848}, {"period": 105, "test_date": "2020-08", "predicted": 9053569987.181961, "actual": 8569027000.0, "error_pct": 5.654585837831542}, {"period": 106, "test_date": "2020-09", "predicted": 9937204448.125, "actual": 9657558000.0, "error_pct": 2.8956227663866994}, {"period": 107, "test_date": "2020-10", "predicted": 8621830262.243317, "actual": 8723786000.0, "error_pct": 1.168709752356183}, {"period": 108, "test_date": "2020-11", "predicted": 8934813639.173042, "actual": 8383006000.0, "error_pct": 6.582455495952673}, {"period": 109, "test_date": "2020-12", "predicted": 8586207819.246962, "actual": 8347896000.0, "error_pct": 2.8547530928387417}, {"period": 110, "test_date": "2021-01", "predicted": 7578582322.322976, "actual": 9211314000.0, "error_pct": 17.725285205531197}, {"period": 111, "test_date": "2021-02", "predicted": 6330750075.780352, "actual": 6832174000.0, "error_pct": 7.339156236648077}, {"period": 112, "test_date": "2021-03", "predicted": 8303379440.886031, "actual": 9093560000.0, "error_pct": 8.689452305961238}, {"period": 113, "test_date": "2021-04", "predicted": 8125547105.668171, "actual": 8004716000.0, "error_pct": 1.509498971208609}, {"period": 114, "test_date": "2021-05", "predicted": 8598313332.888918, "actual": 8421571000.0, "error_pct": 2.0986860158148395}, {"period": 115, "test_date": "2021-06", "predicted": 9076080192.112999, "actual": 8866488000.0, "error_pct": 2.363869348416182}, {"period": 116, "test_date": "2021-07", "predicted": 8708999741.367037, "actual": 8895088000.0, "error_pct": 2.092033925161428}, {"period": 117, "test_date": "2021-08", "predicted": 9447248446.741083, "actual": 8599800000.0, "error_pct": 9.854280875614354}, {"period": 118, "test_date": "2021-09", "predicted": 10311603700.593132, "actual": 9854024000.0, "error_pct": 4.643582160883026}, {"period": 119, "test_date": "2021-10", "predicted": 9454442554.695543, "actual": 9473418000.0, "error_pct": 0.20030199558867465}, {"period": 120, "test_date": "2021-11", "predicted": 9489329911.116064, "actual": 10317316000.0, "error_pct": 8.025208192556436}, {"period": 121, "test_date": "2021-12", "predicted": 9143075948.34789, "actual": 9994978000.0, "error_pct": 8.523300918242233}, {"period": 122, "test_date": "2022-01", "predicted": 8557833506.388295, "actual": 9928201000.0, "error_pct": 13.802777498276928}, {"period": 123, "test_date": "2022-02", "predicted": 6710234462.087288, "actual": 8313488000.0, "error_pct": 19.284968450218635}, {"period": 124, "test_date": "2022-03", "predicted": 9518723413.14902, "actual": 10603963000.0, "error_pct": 10.234283039755804}, {"period": 125, "test_date": "2022-04", "predicted": 8956054589.681017, "actual": 8060503000.0, "error_pct": 11.11036854252169}, {"period": 126, "test_date": "2022-05", "predicted": 9614234947.31313, "actual": 9863250000.0, "error_pct": 2.5246754638366724}, {"period": 127, "test_date": "2022-06", "predicted": 9860767966.099577, "actual": 10728048000.0, "error_pct": 8.08422961847694}, {"period": 128, "test_date": "2022-07", "predicted": 9597611751.284906, "actual": 10302508000.0, "error_pct": 6.841986909547594}, {"period": 129, "test_date": "2022-08", "predicted": 10340144508.676884, "actual": 10261684000.0, "error_pct": 0.7645968115650774}, {"period": 130, "test_date": "2022-09", "predicted": 11389784314.825436, "actual": 10096600000.0, "error_pct": 12.808116740540735}, {"period": 131, "test_date": "2022-10", "predicted": 10927627803.143658, "actual": 9392634000.0, "error_pct": 16.34252759283134}, {"period": 132, "test_date": "2022-11", "predicted": 10963694289.716202, "actual": 9643687000.0, "error_pct": 13.68778652517654}, {"period": 133, "test_date": "2022-12", "predicted": 10267080135.112371, "actual": 8565939000.0, "error_pct": 19.859365506949928}, {"period": 134, "test_date": "2023-01", "predicted": 9140263589.277456, "actual": 7088704000.0, "error_pct": 28.941250604870174}, {"period": 135, "test_date": "2023-02", "predicted": 7030786862.369059, "actual": 6863311000.0, "error_pct": 2.440161350244199}, {"period": 136, "test_date": "2023-03", "predicted": 10544497005.205725, "actual": 8769945000.0, "error_pct": 20.23447131316929}, {"period": 137, "test_date": "2023-04", "predicted": 8928719419.134853, "actual": 7873565000.0, "error_pct": 13.401228276325316}, {"period": 138, "test_date": "2023-05", "predicted": 10025106342.893286, "actual": 8453826000.0, "error_pct": 18.586617975024396}, {"period": 139, "test_date": "2023-06", "predicted": 9907878839.706507, "actual": 9035308000.0, "error_pct": 9.657344715935603}, {"period": 140, "test_date": "2023-07", "predicted": 9436084983.14816, "actual": 8022391000.0, "error_pct": 17.621853424348938}, {"period": 141, "test_date": "2023-08", "predicted": 9792942230.4209, "actual": 8645868000.0, "error_pct": 13.267311395696769}, {"period": 142, "test_date": "2023-09", "predicted": 10231158718.176147, "actual": 9140680000.0, "error_pct": 11.929951799823947}, {"period": 143, "test_date": "2023-10", "predicted": 10136736420.805658, "actual": 8238719000.0, "error_pct": 23.037773479173865}, {"period": 144, "test_date": "2023-11", "predicted": 10094758242.673746, "actual": 8219515000.0, "error_pct": 22.81452424715748}, {"period": 145, "test_date": "2023-12", "predicted": 9091413376.006887, "actual": 7970712000.0, "error_pct": 14.06024174511496}, {"period": 146, "test_date": "2024-01", "predicted": 7570752151.573648, "actual": 7695297000.0, "error_pct": 1.6184540821017244}, {"period": 147, "test_date": "2024-02", "predicted": 5927727942.4090605, "actual": 6640240000.0, "error_pct": 10.73021543785977}, {"period": 148, "test_date": "2024-03", "predicted": 8165381753.693738, "actual": 8510366000.0, "error_pct": 4.0536945920570515}, {"period": 149, "test_date": "2024-04", "predicted": 7882979175.72237, "actual": 7762708000.0, "error_pct": 1.5493456113816229}, {"period": 150, "test_date": "2024-05", "predicted": 8139263790.494749, "actual": 8549876000.0, "error_pct": 4.8025516335587906}, {"period": 151, "test_date": "2024-06", "predicted": 8722175946.437523, "actual": 8361276000.0, "error_pct": 4.316326197550743}, {"period": 152, "test_date": "2024-07", "predicted": 8327927461.88549, "actual": 8380859000.0, "error_pct": 0.6315765259206674}, {"period": 153, "test_date": "2024-08", "predicted": 8620973483.652027, "actual": 9687161000.0, "error_pct": 11.006191766070295}, {"period": 154, "test_date": "2024-09", "predicted": 9470425556.824657, "actual": 9653109000.0, "error_pct": 1.892482962487449}, {"period": 155, "test_date": "2024-10", "predicted": 8350836899.574638, "actual": 9287911000.0, "error_pct": 10.08918044569292}, {"period": 156, "test_date": "2024-11", "predicted": 8441598644.342548, "actual": 8632762000.0, "error_pct": 2.214393906115466}, {"period": 157, "test_date": "2024-12", "predicted": 8083276586.551885, "actual": 8316694000.0, "error_pct": 2.8066129816501046}, {"period": 158, "test_date": "2025-01", "predicted": 7862006095.744654, "actual": 7517508000.0, "error_pct": 4.582610297782905}, {"period": 159, "test_date": "2025-02", "predicted": 6271957560.76334, "actual": 7290720000.0, "error_pct": 13.973413314962857}, {"period": 160, "test_date": "2025-03", "predicted": 8033739096.185393, "actual": 8473057000.0, "error_pct": 5.184880779329192}, {"period": 161, "test_date": "2025-04", "predicted": 7388374824.535849, "actual": 8024350000.0, "error_pct": 7.925566251025335}, {"period": 162, "test_date": "2025-05", "predicted": 7951546919.173514, "actual": 8123837000.0, "error_pct": 2.1207968700810422}, {"period": 163, "test_date": "2025-06", "predicted": 8298252876.22985, "actual": 8346496000.0, "error_pct": 0.5780045155494016}];
                    const tbody = document.getElementById('prophet-tbody');
                    rows.forEach(r => {
                        const tr = document.createElement('tr');
                        function td(v) { const d = document.createElement('td'); d.textContent = (typeof v==='number')? v.toLocaleString(): v; d.title = v; d.className='num'; return d; }
                        tr.appendChild(td(r.period));
                        tr.appendChild(td(r.test_date));
                        tr.appendChild(td(r.predicted));
                        tr.appendChild(td(r.actual));
                        const e = td(r.error_pct);
                        e.className += (r.error_pct>=0 ? ' error-positive' : ' error-negative');
                        tr.appendChild(e);
                        tbody.appendChild(tr);
                    });
                })()
            </script>
        </div>
    
        <div id="xgboost" class="tab-content">
            <h2>🌲 XGBoost 詳細分析</h2>
            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">17.82%</div>
                    <div class="stat-label">MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">56.4%</div>
                    <div class="stat-label">趨勢準確率</div>
                </div>
            </div>
            <div class="chart-container">
                <div id="xgboost-chart" style="height: 500px;"></div>
            </div>
            <h3>詳細回測歷史</h3>
            <div style="max-height: 400px; overflow: auto; border: 1px solid #eee;">
                <table>
                    <thead>
                        <tr>
                            <th>期數</th>
                            <th>回測年月</th>
                            <th>預測數據</th>
                            <th>實際數據</th>
                            <th>誤差(%)</th>
                        </tr>
                    </thead>
                    <tbody id="xgboost-tbody"></tbody>
                </table>
            </div>
            <script>
                (function() {
                    const rows = [{"period": 1, "test_date": "2011-12", "predicted": 1680086272.0, "actual": 1779774000.0, "error_pct": 5.601145313955592}, {"period": 2, "test_date": "2012-01", "predicted": 1698223872.0, "actual": 1248014000.0, "error_pct": 36.07410429690693}, {"period": 3, "test_date": "2012-02", "predicted": 1556565248.0, "actual": 1361917000.0, "error_pct": 14.292225443988144}, {"period": 4, "test_date": "2012-03", "predicted": 1523682560.0, "actual": 1455272000.0, "error_pct": 4.700877911483214}, {"period": 5, "test_date": "2012-04", "predicted": 1533410304.0, "actual": 1519363000.0, "error_pct": 0.9245521972036966}, {"period": 6, "test_date": "2012-05", "predicted": 1482109440.0, "actual": 1635163000.0, "error_pct": 9.360140854459157}, {"period": 7, "test_date": "2012-06", "predicted": 1396819840.0, "actual": 1632237000.0, "error_pct": 14.422976565290458}, {"period": 8, "test_date": "2012-07", "predicted": 1422023424.0, "actual": 1798759000.0, "error_pct": 20.94419408047437}, {"period": 9, "test_date": "2012-08", "predicted": 1495339392.0, "actual": 1987380000.0, "error_pct": 24.758254988980465}, {"period": 10, "test_date": "2012-09", "predicted": 1669091712.0, "actual": 2121336000.0, "error_pct": 21.318842842435146}, {"period": 11, "test_date": "2012-10", "predicted": 2124433664.0, "actual": 2408601000.0, "error_pct": 11.798024496377773}, {"period": 12, "test_date": "2012-11", "predicted": 1819808896.0, "actual": 2587932000.0, "error_pct": 29.680961632685865}, {"period": 13, "test_date": "2012-12", "predicted": 1880295040.0, "actual": 3586626000.0, "error_pct": 47.57482268851004}, {"period": 14, "test_date": "2013-01", "predicted": 1885705216.0, "actual": 5873901000.0, "error_pct": 67.89688460871234}, {"period": 15, "test_date": "2013-02", "predicted": 1466307584.0, "actual": 4721884000.0, "error_pct": 68.94655641688784}, {"period": 16, "test_date": "2013-03", "predicted": 1240001920.0, "actual": 6597561000.0, "error_pct": 81.20514656855768}, {"period": 17, "test_date": "2013-04", "predicted": 1500948736.0, "actual": 5754994000.0, "error_pct": 73.91919546744965}, {"period": 18, "test_date": "2013-05", "predicted": 1520259840.0, "actual": 5941991000.0, "error_pct": 74.4149757211009}, {"period": 19, "test_date": "2013-06", "predicted": 1587994880.0, "actual": 6131932000.0, "error_pct": 74.10286219742815}, {"period": 20, "test_date": "2013-07", "predicted": 1580758144.0, "actual": 5700106000.0, "error_pct": 72.26791670189992}, {"period": 21, "test_date": "2013-08", "predicted": 1597614336.0, "actual": 6083585000.0, "error_pct": 73.73893294825338}, {"period": 22, "test_date": "2013-09", "predicted": 1754445184.0, "actual": 6682871000.0, "error_pct": 73.74713376930364}, {"period": 23, "test_date": "2013-10", "predicted": 1804047232.0, "actual": 6512235000.0, "error_pct": 72.29757169389617}, {"period": 24, "test_date": "2013-11", "predicted": 1757174272.0, "actual": 7414867000.0, "error_pct": 76.30201226805552}, {"period": 25, "test_date": "2013-12", "predicted": 1937201920.0, "actual": 7112682000.0, "error_pct": 72.76411457731416}, {"period": 26, "test_date": "2014-01", "predicted": 2188594176.0, "actual": 5648668000.0, "error_pct": 61.25468560021584}, {"period": 27, "test_date": "2014-02", "predicted": 3350617856.0, "actual": 4932419000.0, "error_pct": 32.06948039085893}, {"period": 28, "test_date": "2014-03", "predicted": 5308495360.0, "actual": 6374006000.0, "error_pct": 16.716498854880275}, {"period": 29, "test_date": "2014-04", "predicted": 5411705344.0, "actual": 6219679000.0, "error_pct": 12.990600576010433}, {"period": 30, "test_date": "2014-05", "predicted": 5107443712.0, "actual": 6343006000.0, "error_pct": 19.47912847630918}, {"period": 31, "test_date": "2014-06", "predicted": 5975142912.0, "actual": 6415313000.0, "error_pct": 6.861241033757823}, {"period": 32, "test_date": "2014-07", "predicted": 5651207680.0, "actual": 6050206000.0, "error_pct": 6.594789003878546}, {"period": 33, "test_date": "2014-08", "predicted": 5846396416.0, "actual": 6078635000.0, "error_pct": 3.820571296022873}, {"period": 34, "test_date": "2014-09", "predicted": 5857670144.0, "actual": 7866553000.0, "error_pct": 25.53701546280817}, {"period": 35, "test_date": "2014-10", "predicted": 5878036992.0, "actual": 7680950000.0, "error_pct": 23.472526289065808}, {"period": 36, "test_date": "2014-11", "predicted": 5858443264.0, "actual": 8123197000.0, "error_pct": 27.880078939363408}, {"period": 37, "test_date": "2014-12", "predicted": 6307565568.0, "actual": 8376832000.0, "error_pct": 24.7022553633641}, {"period": 38, "test_date": "2015-01", "predicted": 6879564800.0, "actual": 6668599000.0, "error_pct": 3.163570039224131}, {"period": 39, "test_date": "2015-02", "predicted": 7023248896.0, "actual": 4898817000.0, "error_pct": 43.36622282481669}, {"period": 40, "test_date": "2015-03", "predicted": 5357338624.0, "actual": 6438739000.0, "error_pct": 16.795219933592588}, {"period": 41, "test_date": "2015-04", "predicted": 6192770048.0, "actual": 6253401000.0, "error_pct": 0.9695676320773289}, {"period": 42, "test_date": "2015-05", "predicted": 5924540416.0, "actual": 6806863000.0, "error_pct": 12.962249776438867}, {"period": 43, "test_date": "2015-06", "predicted": 6103314944.0, "actual": 7198514000.0, "error_pct": 15.214238049686365}, {"period": 44, "test_date": "2015-07", "predicted": 6251134464.0, "actual": 6723583000.0, "error_pct": 7.026737618915391}, {"period": 45, "test_date": "2015-08", "predicted": 6397315072.0, "actual": 6793255000.0, "error_pct": 5.828427285594314}, {"period": 46, "test_date": "2015-09", "predicted": 6611280896.0, "actual": 7517760000.0, "error_pct": 12.057835099816968}, {"period": 47, "test_date": "2015-10", "predicted": 7037194752.0, "actual": 7036601000.0, "error_pct": 0.008438051269355758}, {"period": 48, "test_date": "2015-11", "predicted": 7275052032.0, "actual": 7360885000.0, "error_pct": 1.1660685909370951}, {"period": 49, "test_date": "2015-12", "predicted": 7444980736.0, "actual": 6976597000.0, "error_pct": 6.71364185146426}, {"period": 50, "test_date": "2016-01", "predicted": 7605475328.0, "actual": 5600811000.0, "error_pct": 35.792393780115056}, {"period": 51, "test_date": "2016-02", "predicted": 6497016320.0, "actual": 4592953000.0, "error_pct": 41.45618995012577}, {"period": 52, "test_date": "2016-03", "predicted": 5245390336.0, "actual": 6431429000.0, "error_pct": 18.441292969260797}, {"period": 53, "test_date": "2016-04", "predicted": 6256755200.0, "actual": 5287804000.0, "error_pct": 18.32426466639081}, {"period": 54, "test_date": "2016-05", "predicted": 6148323328.0, "actual": 6051631000.0, "error_pct": 1.5977895545845409}, {"period": 55, "test_date": "2016-06", "predicted": 6872441344.0, "actual": 6921863000.0, "error_pct": 0.7139935592484278}, {"period": 56, "test_date": "2016-07", "predicted": 7035614720.0, "actual": 6219894000.0, "error_pct": 13.11470452711895}, {"period": 57, "test_date": "2016-08", "predicted": 6717054976.0, "actual": 7055487000.0, "error_pct": 4.796720963414716}, {"period": 58, "test_date": "2016-09", "predicted": 7121047040.0, "actual": 7699548000.0, "error_pct": 7.513440529236262}, {"period": 59, "test_date": "2016-10", "predicted": 7937366528.0, "actual": 6754613000.0, "error_pct": 17.510307814822255}, {"period": 60, "test_date": "2016-11", "predicted": 7717170688.0, "actual": 7216573000.0, "error_pct": 6.936778551259719}, {"period": 61, "test_date": "2016-12", "predicted": 7646512640.0, "actual": 7180789000.0, "error_pct": 6.485688968162134}, {"period": 62, "test_date": "2017-01", "predicted": 7571141632.0, "actual": 5143902000.0, "error_pct": 47.18673940522195}, {"period": 63, "test_date": "2017-02", "predicted": 6023299072.0, "actual": 5203731000.0, "error_pct": 15.749624106242234}, {"period": 64, "test_date": "2017-03", "predicted": 4973469184.0, "actual": 6594380000.0, "error_pct": 24.58018518799341}, {"period": 65, "test_date": "2017-04", "predicted": 6317547520.0, "actual": 5405917000.0, "error_pct": 16.863568567552925}, {"period": 66, "test_date": "2017-05", "predicted": 6168083456.0, "actual": 6024573000.0, "error_pct": 2.382085103790758}, {"period": 67, "test_date": "2017-06", "predicted": 6258835968.0, "actual": 7239136000.0, "error_pct": 13.541671713309434}, {"period": 68, "test_date": "2017-07", "predicted": 6274185728.0, "actual": 6159685000.0, "error_pct": 1.8588731079592544}, {"period": 69, "test_date": "2017-08", "predicted": 5815709696.0, "actual": 7144632000.0, "error_pct": 18.600290455827537}, {"period": 70, "test_date": "2017-09", "predicted": 7087141376.0, "actual": 8204632000.0, "error_pct": 13.620240664054158}, {"period": 71, "test_date": "2017-10", "predicted": 7323497472.0, "actual": 7258777000.0, "error_pct": 0.891616755825396}, {"period": 72, "test_date": "2017-11", "predicted": 7573127168.0, "actual": 7168342000.0, "error_pct": 5.646845086353302}, {"period": 73, "test_date": "2017-12", "predicted": 7578948096.0, "actual": 6608609000.0, "error_pct": 14.682955157431769}, {"period": 74, "test_date": "2018-01", "predicted": 7317670912.0, "actual": 6296190000.0, "error_pct": 16.223794262879615}, {"period": 75, "test_date": "2018-02", "predicted": 6067770880.0, "actual": 4645242000.0, "error_pct": 30.623353530343522}, {"period": 76, "test_date": "2018-03", "predicted": 4791942656.0, "actual": 6632412000.0, "error_pct": 27.74962327430805}, {"period": 77, "test_date": "2018-04", "predicted": 6511256064.0, "actual": 6429137000.0, "error_pct": 1.2772952886211633}, {"period": 78, "test_date": "2018-05", "predicted": 6092348928.0, "actual": 7380200000.0, "error_pct": 17.450083629169942}, {"period": 79, "test_date": "2018-06", "predicted": 6823902208.0, "actual": 7452135000.0, "error_pct": 8.430239012041515}, {"period": 80, "test_date": "2018-07", "predicted": 7099097088.0, "actual": 7721252000.0, "error_pct": 8.057694684748018}, {"period": 81, "test_date": "2018-08", "predicted": 6847204352.0, "actual": 8669740000.0, "error_pct": 21.02180282222996}, {"period": 82, "test_date": "2018-09", "predicted": 7347695616.0, "actual": 8584290000.0, "error_pct": 14.405319298392763}, {"period": 83, "test_date": "2018-10", "predicted": 7826734592.0, "actual": 8239915000.0, "error_pct": 5.014377065782838}, {"period": 84, "test_date": "2018-11", "predicted": 7721399808.0, "actual": 8165418000.0, "error_pct": 5.43778887988343}, {"period": 85, "test_date": "2018-12", "predicted": 7536519680.0, "actual": 7044474000.0, "error_pct": 6.984846278089749}, {"period": 86, "test_date": "2019-01", "predicted": 7441475072.0, "actual": 7128216000.0, "error_pct": 4.394634954945249}, {"period": 87, "test_date": "2019-02", "predicted": 5962122752.0, "actual": 4954893000.0, "error_pct": 20.327981895875453}, {"period": 88, "test_date": "2019-03", "predicted": 4967301120.0, "actual": 7094332000.0, "error_pct": 29.98211642759318}, {"period": 89, "test_date": "2019-04", "predicted": 6562159104.0, "actual": 6751644000.0, "error_pct": 2.806500105752021}, {"period": 90, "test_date": "2019-05", "predicted": 6243338240.0, "actual": 7990153000.0, "error_pct": 21.86209400495835}, {"period": 91, "test_date": "2019-06", "predicted": 6914670592.0, "actual": 7809262000.0, "error_pct": 11.455517922180098}, {"period": 92, "test_date": "2019-07", "predicted": 7338868736.0, "actual": 8009584000.0, "error_pct": 8.373908857189088}, {"period": 93, "test_date": "2019-08", "predicted": 7624777728.0, "actual": 9042891000.0, "error_pct": 15.682078574208184}, {"period": 94, "test_date": "2019-09", "predicted": 7219567104.0, "actual": 9133066000.0, "error_pct": 20.951331086406253}, {"period": 95, "test_date": "2019-10", "predicted": 8086736896.0, "actual": 9280205000.0, "error_pct": 12.860363580330391}, {"period": 96, "test_date": "2019-11", "predicted": 8123489792.0, "actual": 8260309000.0, "error_pct": 1.656344913973557}, {"period": 97, "test_date": "2019-12", "predicted": 7634364928.0, "actual": 7097768000.0, "error_pct": 7.560079844818822}, {"period": 98, "test_date": "2020-01", "predicted": 8065703936.0, "actual": 6228700000.0, "error_pct": 29.492573667057332}, {"period": 99, "test_date": "2020-02", "predicted": 6461818368.0, "actual": 4280190000.0, "error_pct": 50.97036271754292}, {"period": 100, "test_date": "2020-03", "predicted": 4900243456.0, "actual": 7601329000.0, "error_pct": 35.534385421286196}, {"period": 101, "test_date": "2020-04", "predicted": 6523828736.0, "actual": 8891424000.0, "error_pct": 26.627852456479413}, {"period": 102, "test_date": "2020-05", "predicted": 7138361856.0, "actual": 8190663000.0, "error_pct": 12.847569775487038}, {"period": 103, "test_date": "2020-06", "predicted": 8219411456.0, "actual": 8014033000.0, "error_pct": 2.562735341868445}, {"period": 104, "test_date": "2020-07", "predicted": 8297744896.0, "actual": 8194616000.0, "error_pct": 1.2584957733223863}, {"period": 105, "test_date": "2020-08", "predicted": 8234706944.0, "actual": 8569027000.0, "error_pct": 3.9014937868675172}, {"period": 106, "test_date": "2020-09", "predicted": 7983255552.0, "actual": 9657558000.0, "error_pct": 17.336706111420714}, {"period": 107, "test_date": "2020-10", "predicted": 8352876032.0, "actual": 8723786000.0, "error_pct": 4.251708696201397}, {"period": 108, "test_date": "2020-11", "predicted": 8284193792.0, "actual": 8383006000.0, "error_pct": 1.1787204733003889}, {"period": 109, "test_date": "2020-12", "predicted": 8618028032.0, "actual": 8347896000.0, "error_pct": 3.2359295324234996}, {"period": 110, "test_date": "2021-01", "predicted": 8193231872.0, "actual": 9211314000.0, "error_pct": 11.052517892669819}, {"period": 111, "test_date": "2021-02", "predicted": 7612864000.0, "actual": 6832174000.0, "error_pct": 11.426670339484915}, {"period": 112, "test_date": "2021-03", "predicted": 7393193984.0, "actual": 9093560000.0, "error_pct": 18.698573671917266}, {"period": 113, "test_date": "2021-04", "predicted": 8328323584.0, "actual": 8004716000.0, "error_pct": 4.042711621499126}, {"period": 114, "test_date": "2021-05", "predicted": 7760649216.0, "actual": 8421571000.0, "error_pct": 7.8479630938218055}, {"period": 115, "test_date": "2021-06", "predicted": 8994437120.0, "actual": 8866488000.0, "error_pct": 1.4430642662573954}, {"period": 116, "test_date": "2021-07", "predicted": 8226224128.0, "actual": 8895088000.0, "error_pct": 7.519474478498695}, {"period": 117, "test_date": "2021-08", "predicted": 8620937216.0, "actual": 8599800000.0, "error_pct": 0.24578729737900884}, {"period": 118, "test_date": "2021-09", "predicted": 8411812864.0, "actual": 9854024000.0, "error_pct": 14.635758305439484}, {"period": 119, "test_date": "2021-10", "predicted": 8525664256.0, "actual": 9473418000.0, "error_pct": 10.004348419968379}, {"period": 120, "test_date": "2021-11", "predicted": 8418661376.0, "actual": 10317316000.0, "error_pct": 18.402602227168384}, {"period": 121, "test_date": "2021-12", "predicted": 8538993152.0, "actual": 9994978000.0, "error_pct": 14.56716410981595}, {"period": 122, "test_date": "2022-01", "predicted": 7391919104.0, "actual": 9928201000.0, "error_pct": 25.5462383970671}, {"period": 123, "test_date": "2022-02", "predicted": 8062487552.0, "actual": 8313488000.0, "error_pct": 3.019195408714128}, {"period": 124, "test_date": "2022-03", "predicted": 8358825472.0, "actual": 10603963000.0, "error_pct": 21.17262695088619}, {"period": 125, "test_date": "2022-04", "predicted": 8914632704.0, "actual": 8060503000.0, "error_pct": 10.596481435463767}, {"period": 126, "test_date": "2022-05", "predicted": 8783635456.0, "actual": 9863250000.0, "error_pct": 10.945829660608826}, {"period": 127, "test_date": "2022-06", "predicted": 9359890432.0, "actual": 10728048000.0, "error_pct": 12.753089546206356}, {"period": 128, "test_date": "2022-07", "predicted": 8789858304.0, "actual": 10302508000.0, "error_pct": 14.682344299077469}, {"period": 129, "test_date": "2022-08", "predicted": 9191449600.0, "actual": 10261684000.0, "error_pct": 10.429422695144384}, {"period": 130, "test_date": "2022-09", "predicted": 8742748160.0, "actual": 10096600000.0, "error_pct": 13.408987579977419}, {"period": 131, "test_date": "2022-10", "predicted": 8736638976.0, "actual": 9392634000.0, "error_pct": 6.984143361702372}, {"period": 132, "test_date": "2022-11", "predicted": 8788484096.0, "actual": 9643687000.0, "error_pct": 8.868007682124066}, {"period": 133, "test_date": "2022-12", "predicted": 8888162304.0, "actual": 8565939000.0, "error_pct": 3.761681048627594}, {"period": 134, "test_date": "2023-01", "predicted": 9480598528.0, "actual": 7088704000.0, "error_pct": 33.742338909905115}, {"period": 135, "test_date": "2023-02", "predicted": 9088405504.0, "actual": 6863311000.0, "error_pct": 32.42013226560766}, {"period": 136, "test_date": "2023-03", "predicted": 7011848192.0, "actual": 8769945000.0, "error_pct": 20.046839609598464}, {"period": 137, "test_date": "2023-04", "predicted": 8061110784.0, "actual": 7873565000.0, "error_pct": 2.3819678125474293}, {"period": 138, "test_date": "2023-05", "predicted": 8432667136.0, "actual": 8453826000.0, "error_pct": 0.25028743198641656}, {"period": 139, "test_date": "2023-06", "predicted": 9236439040.0, "actual": 9035308000.0, "error_pct": 2.226056267257298}, {"period": 140, "test_date": "2023-07", "predicted": 9045854208.0, "actual": 8022391000.0, "error_pct": 12.757583219267174}, {"period": 141, "test_date": "2023-08", "predicted": 8968167424.0, "actual": 8645868000.0, "error_pct": 3.7277856196740453}, {"period": 142, "test_date": "2023-09", "predicted": 8853567488.0, "actual": 9140680000.0, "error_pct": 3.1410410604025087}, {"period": 143, "test_date": "2023-10", "predicted": 9134024704.0, "actual": 8238719000.0, "error_pct": 10.867049889673384}, {"period": 144, "test_date": "2023-11", "predicted": 8819864576.0, "actual": 8219515000.0, "error_pct": 7.303953773428237}, {"period": 145, "test_date": "2023-12", "predicted": 8913726464.0, "actual": 7970712000.0, "error_pct": 11.830994069287662}, {"period": 146, "test_date": "2024-01", "predicted": 8342861312.0, "actual": 7695297000.0, "error_pct": 8.415065877249441}, {"period": 147, "test_date": "2024-02", "predicted": 7766335488.0, "actual": 6640240000.0, "error_pct": 16.95865643410479}, {"period": 148, "test_date": "2024-03", "predicted": 6893459456.0, "actual": 8510366000.0, "error_pct": 18.999259773316446}, {"period": 149, "test_date": "2024-04", "predicted": 7915627008.0, "actual": 7762708000.0, "error_pct": 1.9699183326231}, {"period": 150, "test_date": "2024-05", "predicted": 8102285312.0, "actual": 8549876000.0, "error_pct": 5.235054730618315}, {"period": 151, "test_date": "2024-06", "predicted": 8741063680.0, "actual": 8361276000.0, "error_pct": 4.542221546089377}, {"period": 152, "test_date": "2024-07", "predicted": 8375074304.0, "actual": 8380859000.0, "error_pct": 0.06902270996326272}, {"period": 153, "test_date": "2024-08", "predicted": 8557964288.0, "actual": 9687161000.0, "error_pct": 11.656632030787968}, {"period": 154, "test_date": "2024-09", "predicted": 9011564544.0, "actual": 9653109000.0, "error_pct": 6.645987898820992}, {"period": 155, "test_date": "2024-10", "predicted": 9662947328.0, "actual": 9287911000.0, "error_pct": 4.037897520766511}, {"period": 156, "test_date": "2024-11", "predicted": 9576630272.0, "actual": 8632762000.0, "error_pct": 10.933560684286212}, {"period": 157, "test_date": "2024-12", "predicted": 9084076032.0, "actual": 8316694000.0, "error_pct": 9.227008135684684}, {"period": 158, "test_date": "2025-01", "predicted": 8464414720.0, "actual": 7517508000.0, "error_pct": 12.596018787076781}, {"period": 159, "test_date": "2025-02", "predicted": 7443923968.0, "actual": 7290720000.0, "error_pct": 2.1013558057366075}, {"period": 160, "test_date": "2025-03", "predicted": 7309493248.0, "actual": 8473057000.0, "error_pct": 13.732514156342864}, {"period": 161, "test_date": "2025-04", "predicted": 8245600256.0, "actual": 8024350000.0, "error_pct": 2.7572358633409557}, {"period": 162, "test_date": "2025-05", "predicted": 8452182016.0, "actual": 8123837000.0, "error_pct": 4.041747957276839}, {"period": 163, "test_date": "2025-06", "predicted": 8284140032.0, "actual": 8346496000.0, "error_pct": 0.7470915699234745}];
                    const tbody = document.getElementById('xgboost-tbody');
                    rows.forEach(r => {
                        const tr = document.createElement('tr');
                        function td(v) { const d = document.createElement('td'); d.textContent = (typeof v==='number')? v.toLocaleString(): v; d.title = v; d.className='num'; return d; }
                        tr.appendChild(td(r.period));
                        tr.appendChild(td(r.test_date));
                        tr.appendChild(td(r.predicted));
                        tr.appendChild(td(r.actual));
                        const e = td(r.error_pct);
                        e.className += (r.error_pct>=0 ? ' error-positive' : ' error-negative');
                        tr.appendChild(e);
                        tbody.appendChild(tr);
                    });
                })()
            </script>
        </div>
    
    </div>

    <script>
        // 圖表數據
        const chartData = {"periods": ["2011-12", "2012-01", "2012-02", "2012-03", "2012-04", "2012-05", "2012-06", "2012-07", "2012-08", "2012-09", "2012-10", "2012-11", "2012-12", "2013-01", "2013-02", "2013-03", "2013-04", "2013-05", "2013-06", "2013-07", "2013-08", "2013-09", "2013-10", "2013-11", "2013-12", "2014-01", "2014-02", "2014-03", "2014-04", "2014-05", "2014-06", "2014-07", "2014-08", "2014-09", "2014-10", "2014-11", "2014-12", "2015-01", "2015-02", "2015-03", "2015-04", "2015-05", "2015-06", "2015-07", "2015-08", "2015-09", "2015-10", "2015-11", "2015-12", "2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12", "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12", "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12", "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12", "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06"], "actual": [1779774000.0, 1248014000.0, 1361917000.0, 1455272000.0, 1519363000.0, 1635163000.0, 1632237000.0, 1798759000.0, 1987380000.0, 2121336000.0, 2408601000.0, 2587932000.0, 3586626000.0, 5873901000.0, 4721884000.0, 6597561000.0, 5754994000.0, 5941991000.0, 6131932000.0, 5700106000.0, 6083585000.0, 6682871000.0, 6512235000.0, 7414867000.0, 7112682000.0, 5648668000.0, 4932419000.0, 6374006000.0, 6219679000.0, 6343006000.0, 6415313000.0, 6050206000.0, 6078635000.0, 7866553000.0, 7680950000.0, 8123197000.0, 8376832000.0, 6668599000.0, 4898817000.0, 6438739000.0, 6253401000.0, 6806863000.0, 7198514000.0, 6723583000.0, 6793255000.0, 7517760000.0, 7036601000.0, 7360885000.0, 6976597000.0, 5600811000.0, 4592953000.0, 6431429000.0, 5287804000.0, 6051631000.0, 6921863000.0, 6219894000.0, 7055487000.0, 7699548000.0, 6754613000.0, 7216573000.0, 7180789000.0, 5143902000.0, 5203731000.0, 6594380000.0, 5405917000.0, 6024573000.0, 7239136000.0, 6159685000.0, 7144632000.0, 8204632000.0, 7258777000.0, 7168342000.0, 6608609000.0, 6296190000.0, 4645242000.0, 6632412000.0, 6429137000.0, 7380200000.0, 7452135000.0, 7721252000.0, 8669740000.0, 8584290000.0, 8239915000.0, 8165418000.0, 7044474000.0, 7128216000.0, 4954893000.0, 7094332000.0, 6751644000.0, 7990153000.0, 7809262000.0, 8009584000.0, 9042891000.0, 9133066000.0, 9280205000.0, 8260309000.0, 7097768000.0, 6228700000.0, 4280190000.0, 7601329000.0, 8891424000.0, 8190663000.0, 8014033000.0, 8194616000.0, 8569027000.0, 9657558000.0, 8723786000.0, 8383006000.0, 8347896000.0, 9211314000.0, 6832174000.0, 9093560000.0, 8004716000.0, 8421571000.0, 8866488000.0, 8895088000.0, 8599800000.0, 9854024000.0, 9473418000.0, 10317316000.0, 9994978000.0, 9928201000.0, 8313488000.0, 10603963000.0, 8060503000.0, 9863250000.0, 10728048000.0, 10302508000.0, 10261684000.0, 10096600000.0, 9392634000.0, 9643687000.0, 8565939000.0, 7088704000.0, 6863311000.0, 8769945000.0, 7873565000.0, 8453826000.0, 9035308000.0, 8022391000.0, 8645868000.0, 9140680000.0, 8238719000.0, 8219515000.0, 7970712000.0, 7695297000.0, 6640240000.0, 8510366000.0, 7762708000.0, 8549876000.0, 8361276000.0, 8380859000.0, 9687161000.0, 9653109000.0, 9287911000.0, 8632762000.0, 8316694000.0, 7517508000.0, 7290720000.0, 8473057000.0, 8024350000.0, 8123837000.0, 8346496000.0], "models": {"Prophet": {"predictions": [1280740619.4378948, 1586046138.893268, 561117522.9947714, 1550915675.398681, 2189730856.6111116, 1735528927.1437817, 1251628384.744397, 1214009101.2922027, 1504603006.7298121, 2432611142.6988716, 2473830693.2810225, 3062274700.326778, 1907272847.3775158, 2596088373.756127, 4089811629.770335, 5487930869.394059, 7008195691.940132, 5473472763.921561, 5404032951.945535, 6547586886.042964, 5960005361.403139, 6913589740.627511, 6712247266.408046, 7219858689.388716, 8746709403.501795, 7840426104.700977, 4974015730.262829, 6576657337.195359, 5298049540.001785, 5905013577.161407, 5924754510.556249, 5664210071.961297, 6069541751.394506, 7395098406.514104, 6921761643.947831, 8611496762.243128, 8159902772.663191, 5589062167.907922, 5848616582.704639, 7786653204.851375, 7394023239.800808, 7009343256.119253, 6896968794.082286, 6191490616.907748, 5958444373.103093, 8381802428.136128, 7990806551.899401, 9101922092.43867, 9250285830.86511, 5931538603.60922, 4863103891.813024, 6310691212.880725, 5725313667.362301, 5786212947.911183, 5996811772.952022, 5959222188.920571, 6162095697.644727, 7150707063.858178, 6622971454.575463, 6749571191.825383, 6626120100.110046, 6832208828.820733, 5186716958.698482, 6283133013.103116, 5590352494.827552, 6018414022.774128, 6432253075.580138, 6054215475.527834, 6530864583.391237, 7507851798.469116, 7067605982.820854, 7539652037.35254, 7365305193.479966, 6093464307.537715, 5174333298.306779, 6642817945.205283, 6050009011.615663, 6472788030.892595, 6992148684.037953, 6507217240.919819, 7023588480.937802, 8436342422.587008, 7998111991.34116, 8562171443.237794, 8384827094.034891, 6848710190.62031, 5542594531.911112, 7592702737.056445, 7277166290.198002, 7750505280.972808, 7771521214.654314, 7544779654.102165, 7824858233.841808, 8935098621.154428, 8815765609.066223, 9336065634.879025, 8829218909.140095, 7520212117.619076, 5664262591.073432, 7742541395.990896, 6718333777.032738, 7561129392.354336, 8911175013.115463, 8087769830.057258, 9053569987.181961, 9937204448.125, 8621830262.243317, 8934813639.173042, 8586207819.246962, 7578582322.322976, 6330750075.780352, 8303379440.886031, 8125547105.668171, 8598313332.888918, 9076080192.112999, 8708999741.367037, 9447248446.741083, 10311603700.593132, 9454442554.695543, 9489329911.116064, 9143075948.34789, 8557833506.388295, 6710234462.087288, 9518723413.14902, 8956054589.681017, 9614234947.31313, 9860767966.099577, 9597611751.284906, 10340144508.676884, 11389784314.825436, 10927627803.143658, 10963694289.716202, 10267080135.112371, 9140263589.277456, 7030786862.369059, 10544497005.205725, 8928719419.134853, 10025106342.893286, 9907878839.706507, 9436084983.14816, 9792942230.4209, 10231158718.176147, 10136736420.805658, 10094758242.673746, 9091413376.006887, 7570752151.573648, 5927727942.4090605, 8165381753.693738, 7882979175.72237, 8139263790.494749, 8722175946.437523, 8327927461.88549, 8620973483.652027, 9470425556.824657, 8350836899.574638, 8441598644.342548, 8083276586.551885, 7862006095.744654, 6271957560.76334, 8033739096.185393, 7388374824.535849, 7951546919.173514, 8298252876.22985]}, "XGBoost": {"predictions": [1680086272.0, 1698223872.0, 1556565248.0, 1523682560.0, 1533410304.0, 1482109440.0, 1396819840.0, 1422023424.0, 1495339392.0, 1669091712.0, 2124433664.0, 1819808896.0, 1880295040.0, 1885705216.0, 1466307584.0, 1240001920.0, 1500948736.0, 1520259840.0, 1587994880.0, 1580758144.0, 1597614336.0, 1754445184.0, 1804047232.0, 1757174272.0, 1937201920.0, 2188594176.0, 3350617856.0, 5308495360.0, 5411705344.0, 5107443712.0, 5975142912.0, 5651207680.0, 5846396416.0, 5857670144.0, 5878036992.0, 5858443264.0, 6307565568.0, 6879564800.0, 7023248896.0, 5357338624.0, 6192770048.0, 5924540416.0, 6103314944.0, 6251134464.0, 6397315072.0, 6611280896.0, 7037194752.0, 7275052032.0, 7444980736.0, 7605475328.0, 6497016320.0, 5245390336.0, 6256755200.0, 6148323328.0, 6872441344.0, 7035614720.0, 6717054976.0, 7121047040.0, 7937366528.0, 7717170688.0, 7646512640.0, 7571141632.0, 6023299072.0, 4973469184.0, 6317547520.0, 6168083456.0, 6258835968.0, 6274185728.0, 5815709696.0, 7087141376.0, 7323497472.0, 7573127168.0, 7578948096.0, 7317670912.0, 6067770880.0, 4791942656.0, 6511256064.0, 6092348928.0, 6823902208.0, 7099097088.0, 6847204352.0, 7347695616.0, 7826734592.0, 7721399808.0, 7536519680.0, 7441475072.0, 5962122752.0, 4967301120.0, 6562159104.0, 6243338240.0, 6914670592.0, 7338868736.0, 7624777728.0, 7219567104.0, 8086736896.0, 8123489792.0, 7634364928.0, 8065703936.0, 6461818368.0, 4900243456.0, 6523828736.0, 7138361856.0, 8219411456.0, 8297744896.0, 8234706944.0, 7983255552.0, 8352876032.0, 8284193792.0, 8618028032.0, 8193231872.0, 7612864000.0, 7393193984.0, 8328323584.0, 7760649216.0, 8994437120.0, 8226224128.0, 8620937216.0, 8411812864.0, 8525664256.0, 8418661376.0, 8538993152.0, 7391919104.0, 8062487552.0, 8358825472.0, 8914632704.0, 8783635456.0, 9359890432.0, 8789858304.0, 9191449600.0, 8742748160.0, 8736638976.0, 8788484096.0, 8888162304.0, 9480598528.0, 9088405504.0, 7011848192.0, 8061110784.0, 8432667136.0, 9236439040.0, 9045854208.0, 8968167424.0, 8853567488.0, 9134024704.0, 8819864576.0, 8913726464.0, 8342861312.0, 7766335488.0, 6893459456.0, 7915627008.0, 8102285312.0, 8741063680.0, 8375074304.0, 8557964288.0, 9011564544.0, 9662947328.0, 9576630272.0, 9084076032.0, 8464414720.0, 7443923968.0, 7309493248.0, 8245600256.0, 8452182016.0, 8284140032.0]}}};

        // 初始化圖表
        initializeCharts();

        function showTab(tabName) {
            // 隱藏所有內容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 顯示選中的內容
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // 重新渲染圖表（Plotly需要）
            setTimeout(() => {
                Plotly.Plots.resize();
            }, 100);
        }

        function initializeCharts() {
            // 總覽對比圖
            createComparisonChart();

            // 各模型詳細圖
            createModelChart('Prophet');
            createModelChart('XGBoost');
        }

        function createComparisonChart() {
            const traces = [];

            // 實際值（只需要一條線）
            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            // 各模型預測值
            const colors = ['#A23B72', '#F18F01', '#C73E1D', '#7209B7'];
            let colorIndex = 0;

            Object.keys(chartData.models).forEach(modelName => {
                const modelData = chartData.models[modelName];
                traces.push({
                    x: chartData.periods,
                    y: modelData.predictions,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `${modelName} 預測`,
                    line: { color: colors[colorIndex % colors.length], width: 2, dash: 'dot' },
                    marker: { size: 4 }
                });
                colorIndex++;
            });

            const layout = {
                title: '所有模型預測對比',
                xaxis: { title: '回測期數' },
                yaxis: {
                    title: '營收 (億元)',
                    tickformat: '.1f'
                },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };

            Plotly.newPlot('comparison-chart', traces, layout, {responsive: true});
        }

        
        function createModelChart(modelName) {
            const divId = modelName.toLowerCase() + '-chart';
            const preds = chartData.models[modelName]?.predictions || [];
            const traces = [];

            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual.map(v => v/1e8),
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            traces.push({
                x: chartData.periods,
                y: preds.map(v => v/1e8),
                type: 'scatter',
                mode: 'lines+markers',
                name: modelName + ' 預測',
                line: { color: '#A23B72', width: 2, dash: 'dot' },
                marker: { size: 4 }
            });

            const layout = {
                title: modelName + ' 模型：預測 vs 實際',
                xaxis: { title: '回測年月' },
                yaxis: { title: '營收 (億元)' },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };
            Plotly.newPlot(divId, traces, layout, {responsive: true});
        }
    
    </script>
</body>
</html>