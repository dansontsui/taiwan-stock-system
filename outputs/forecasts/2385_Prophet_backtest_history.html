<!DOCTYPE html>
<html lang='zh-Hant'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>2385 互動式回測分析</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #e9ecef;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .tab:hover {
            background: #dee2e6;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #667eea;
            color: #667eea;
        }
        .tab-content {
            display: none;
            padding: 30px;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }
        .model-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #dee2e6;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:hover {
            background: #f1f7ff;
        }
        .num {
            font-variant-numeric: tabular-nums;
        }
        .error-positive {
            color: #dc3545;
        }
        .error-negative {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>2385 互動式回測分析</h1>
            <p>所有模型的預測表現與詳細歷史</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">📊 總覽</button>
            <button class="tab" onclick="showTab('prophet')">📐 Prophet</button>
        </div>

        <!-- 總覽頁面 -->
        <div id="overview" class="tab-content active">
            <h2>📈 所有模型預測對比</h2>
            <div class="chart-container">
                <div id="comparison-chart" style="height: 600px;"></div>
            </div>

            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.00%</div>
                    <div class="stat-label">Prophet MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">Prophet 趨勢準確率</div>
                </div>
            </div>
        </div>
        <div id="prophet" class="tab-content">
            <h2>📐 Prophet 詳細分析</h2>
            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.00%</div>
                    <div class="stat-label">MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">趨勢準確率</div>
                </div>
            </div>
            <div class="chart-container">
                <div id="prophet-chart" style="height: 500px;"></div>
            </div>
            <h3>詳細回測歷史</h3>
            <div style="max-height: 400px; overflow: auto; border: 1px solid #eee;">
                <table>
                    <thead>
                        <tr>
                            <th>期數</th>
                            <th>回測年月</th>
                            <th>預測數據</th>
                            <th>實際數據</th>
                            <th>誤差(%)</th>
                        </tr>
                    </thead>
                    <tbody id="prophet-tbody"></tbody>
                </table>
            </div>
            <script>
                (function() {
                    const rows = [{"period": 1, "test_date": "2011-12", "predicted": 1280740619.4378948, "actual": 1779774000.0, "error_pct": 28.03914320369357}, {"period": 2, "test_date": "2012-01", "predicted": 1586046138.893268, "actual": 1248014000.0, "error_pct": 27.08560472024097}, {"period": 3, "test_date": "2012-02", "predicted": 561117522.9947714, "actual": 1361917000.0, "error_pct": 58.79943322575668}, {"period": 4, "test_date": "2012-03", "predicted": 1550915675.398681, "actual": 1455272000.0, "error_pct": 6.572219859839324}, {"period": 5, "test_date": "2012-04", "predicted": 2189730856.611112, "actual": 1519363000.0, "error_pct": 44.12163891124844}, {"period": 6, "test_date": "2012-05", "predicted": 1735528927.1437817, "actual": 1635163000.0, "error_pct": 6.137976895501039}, {"period": 7, "test_date": "2012-06", "predicted": 1251628384.744397, "actual": 1632237000.0, "error_pct": 23.318220041305462}, {"period": 8, "test_date": "2012-07", "predicted": 1214009101.2922027, "actual": 1798759000.0, "error_pct": 32.508518301106335}, {"period": 9, "test_date": "2012-08", "predicted": 1504603006.729812, "actual": 1987380000.0, "error_pct": 24.29213302288379}, {"period": 10, "test_date": "2012-09", "predicted": 2432611142.698872, "actual": 2121336000.0, "error_pct": 14.673542649484649}, {"period": 11, "test_date": "2012-10", "predicted": 2473830693.2810225, "actual": 2408601000.0, "error_pct": 2.7081983807622163}, {"period": 12, "test_date": "2012-11", "predicted": 3062274700.326778, "actual": 2587932000.0, "error_pct": 18.329024886541763}, {"period": 13, "test_date": "2012-12", "predicted": 1907272847.377516, "actual": 3586626000.0, "error_pct": 46.82264480942491}, {"period": 14, "test_date": "2013-01", "predicted": 2596088373.756127, "actual": 5873901000.0, "error_pct": 55.80299406210409}, {"period": 15, "test_date": "2013-02", "predicted": 4089811629.770335, "actual": 4721884000.0, "error_pct": 13.386020711852828}, {"period": 16, "test_date": "2013-03", "predicted": 5487930869.394059, "actual": 6597561000.0, "error_pct": 16.81879304497436}, {"period": 17, "test_date": "2013-04", "predicted": 7008195691.940132, "actual": 5754994000.0, "error_pct": 21.775899191904145}, {"period": 18, "test_date": "2013-05", "predicted": 5473472763.921561, "actual": 5941991000.0, "error_pct": 7.884869500449239}, {"period": 19, "test_date": "2013-06", "predicted": 5404032951.945535, "actual": 6131932000.0, "error_pct": 11.870631442985104}, {"period": 20, "test_date": "2013-07", "predicted": 6547586886.042964, "actual": 5700106000.0, "error_pct": 14.867809230968057}, {"period": 21, "test_date": "2013-08", "predicted": 5960005361.403139, "actual": 6083585000.0, "error_pct": 2.031362076750155}, {"period": 22, "test_date": "2013-09", "predicted": 6913589740.627511, "actual": 6682871000.0, "error_pct": 3.452389558731734}, {"period": 23, "test_date": "2013-10", "predicted": 6712247266.408046, "actual": 6512235000.0, "error_pct": 3.0713306016758573}, {"period": 24, "test_date": "2013-11", "predicted": 7219858689.388716, "actual": 7414867000.0, "error_pct": 2.629963701456604}, {"period": 25, "test_date": "2013-12", "predicted": 8746709403.501795, "actual": 7112682000.0, "error_pct": 22.97343538628319}, {"period": 26, "test_date": "2014-01", "predicted": 7840426104.700977, "actual": 5648668000.0, "error_pct": 38.80132634279404}, {"period": 27, "test_date": "2014-02", "predicted": 4974015730.262829, "actual": 4932419000.0, "error_pct": 0.843333266351233}, {"period": 28, "test_date": "2014-03", "predicted": 6576657337.195359, "actual": 6374006000.0, "error_pct": 3.179340232741532}, {"period": 29, "test_date": "2014-04", "predicted": 5298049540.001785, "actual": 6219679000.0, "error_pct": 14.817958611661709}, {"period": 30, "test_date": "2014-05", "predicted": 5905013577.161407, "actual": 6343006000.0, "error_pct": 6.905123892971132}, {"period": 31, "test_date": "2014-06", "predicted": 5924754510.556249, "actual": 6415313000.0, "error_pct": 7.646680519621589}, {"period": 32, "test_date": "2014-07", "predicted": 5664210071.961297, "actual": 6050206000.0, "error_pct": 6.379880751807508}, {"period": 33, "test_date": "2014-08", "predicted": 6069541751.394506, "actual": 6078635000.0, "error_pct": 0.149593594704955}, {"period": 34, "test_date": "2014-09", "predicted": 7395098406.514104, "actual": 7866553000.0, "error_pct": 5.993153462334725}, {"period": 35, "test_date": "2014-10", "predicted": 6921761643.947831, "actual": 7680950000.0, "error_pct": 9.88404241730735}, {"period": 36, "test_date": "2014-11", "predicted": 8611496762.243128, "actual": 8123197000.0, "error_pct": 6.0111771540580365}, {"period": 37, "test_date": "2014-12", "predicted": 8159902772.663191, "actual": 8376832000.0, "error_pct": 2.589633256782625}, {"period": 38, "test_date": "2015-01", "predicted": 5589062167.907922, "actual": 6668599000.0, "error_pct": 16.188360285152523}, {"period": 39, "test_date": "2015-02", "predicted": 5848616582.704639, "actual": 4898817000.0, "error_pct": 19.38834585379775}, {"period": 40, "test_date": "2015-03", "predicted": 7786653204.851375, "actual": 6438739000.0, "error_pct": 20.93444391598067}, {"period": 41, "test_date": "2015-04", "predicted": 7394023239.800808, "actual": 6253401000.0, "error_pct": 18.24003034190208}, {"period": 42, "test_date": "2015-05", "predicted": 7009343256.119253, "actual": 6806863000.0, "error_pct": 2.974648617421169}, {"period": 43, "test_date": "2015-06", "predicted": 6896968794.082286, "actual": 7198514000.0, "error_pct": 4.18899242145968}, {"period": 44, "test_date": "2015-07", "predicted": 6191490616.907748, "actual": 6723583000.0, "error_pct": 7.913821887708559}, {"period": 45, "test_date": "2015-08", "predicted": 5958444373.103093, "actual": 6793255000.0, "error_pct": 12.288816287580945}, {"period": 46, "test_date": "2015-09", "predicted": 8381802428.136128, "actual": 7517760000.0, "error_pct": 11.493349456967614}, {"period": 47, "test_date": "2015-10", "predicted": 7990806551.899401, "actual": 7036601000.0, "error_pct": 13.56060336374623}, {"period": 48, "test_date": "2015-11", "predicted": 9101922092.43867, "actual": 7360885000.0, "error_pct": 23.65255118696555}, {"period": 49, "test_date": "2015-12", "predicted": 9250285830.86511, "actual": 6976597000.0, "error_pct": 32.59022745423177}, {"period": 50, "test_date": "2016-01", "predicted": 5931538603.60922, "actual": 5600811000.0, "error_pct": 5.904994894653998}, {"period": 51, "test_date": "2016-02", "predicted": 4863103891.813024, "actual": 4592953000.0, "error_pct": 5.8818562221956885}, {"period": 52, "test_date": "2016-03", "predicted": 6310691212.880725, "actual": 6431429000.0, "error_pct": 1.8773088705367824}, {"period": 53, "test_date": "2016-04", "predicted": 5725313667.362301, "actual": 5287804000.0, "error_pct": 8.273938810180953}, {"period": 54, "test_date": "2016-05", "predicted": 5786212947.911183, "actual": 6051631000.0, "error_pct": 4.385892862417036}, {"period": 55, "test_date": "2016-06", "predicted": 5996811772.952022, "actual": 6921863000.0, "error_pct": 13.364194394601256}, {"period": 56, "test_date": "2016-07", "predicted": 5959222188.920571, "actual": 6219894000.0, "error_pct": 4.190936550999562}, {"period": 57, "test_date": "2016-08", "predicted": 6162095697.644727, "actual": 7055487000.0, "error_pct": 12.66236196530832}, {"period": 58, "test_date": "2016-09", "predicted": 7150707063.858178, "actual": 7699548000.0, "error_pct": 7.128222801414082}, {"period": 59, "test_date": "2016-10", "predicted": 6622971454.575463, "actual": 6754613000.0, "error_pct": 1.948913215672559}, {"period": 60, "test_date": "2016-11", "predicted": 6749571191.825383, "actual": 7216573000.0, "error_pct": 6.471240686883051}, {"period": 61, "test_date": "2016-12", "predicted": 6626120100.110046, "actual": 7180789000.0, "error_pct": 7.724344774508116}, {"period": 62, "test_date": "2017-01", "predicted": 6832208828.820733, "actual": 5143902000.0, "error_pct": 32.8215200993474}, {"period": 63, "test_date": "2017-02", "predicted": 5186716958.698482, "actual": 5203731000.0, "error_pct": 0.326958509221911}, {"period": 64, "test_date": "2017-03", "predicted": 6283133013.103116, "actual": 6594380000.0, "error_pct": 4.719882489284572}, {"period": 65, "test_date": "2017-04", "predicted": 5590352494.827552, "actual": 5405917000.0, "error_pct": 3.4117337507688674}, {"period": 66, "test_date": "2017-05", "predicted": 6018414022.774128, "actual": 6024573000.0, "error_pct": 0.1022309336424679}, {"period": 67, "test_date": "2017-06", "predicted": 6432253075.580138, "actual": 7239136000.0, "error_pct": 11.14612191869115}, {"period": 68, "test_date": "2017-07", "predicted": 6054215475.527834, "actual": 6159685000.0, "error_pct": 1.7122551635703136}, {"period": 69, "test_date": "2017-08", "predicted": 6530864583.391237, "actual": 7144632000.0, "error_pct": 8.590609237939235}, {"period": 70, "test_date": "2017-09", "predicted": 7507851798.469116, "actual": 8204632000.0, "error_pct": 8.49252229144322}, {"period": 71, "test_date": "2017-10", "predicted": 7067605982.820854, "actual": 7258777000.0, "error_pct": 2.6336532611367702}, {"period": 72, "test_date": "2017-11", "predicted": 7539652037.35254, "actual": 7168342000.0, "error_pct": 5.17985940615752}, {"period": 73, "test_date": "2017-12", "predicted": 7365305193.479966, "actual": 6608609000.0, "error_pct": 11.450158323483295}, {"period": 74, "test_date": "2018-01", "predicted": 6093464307.537715, "actual": 6296190000.0, "error_pct": 3.2198153559896547}, {"period": 75, "test_date": "2018-02", "predicted": 5174333298.306779, "actual": 4645242000.0, "error_pct": 11.389961993514632}, {"period": 76, "test_date": "2018-03", "predicted": 6642817945.205283, "actual": 6632412000.0, "error_pct": 0.1568953377034352}, {"period": 77, "test_date": "2018-04", "predicted": 6050009011.615663, "actual": 6429137000.0, "error_pct": 5.897027678587926}, {"period": 78, "test_date": "2018-05", "predicted": 6472788030.892595, "actual": 7380200000.0, "error_pct": 12.295221933110277}, {"period": 79, "test_date": "2018-06", "predicted": 6992148684.037953, "actual": 7452135000.0, "error_pct": 6.172544055657159}, {"period": 80, "test_date": "2018-07", "predicted": 6507217240.919819, "actual": 7721252000.0, "error_pct": 15.72328890548037}, {"period": 81, "test_date": "2018-08", "predicted": 7023588480.937802, "actual": 8669740000.0, "error_pct": 18.98732279240436}, {"period": 82, "test_date": "2018-09", "predicted": 8436342422.587008, "actual": 8584290000.0, "error_pct": 1.7234690045768668}, {"period": 83, "test_date": "2018-10", "predicted": 7998111991.34116, "actual": 8239915000.0, "error_pct": 2.9345328035403297}, {"period": 84, "test_date": "2018-11", "predicted": 8562171443.237794, "actual": 8165418000.0, "error_pct": 4.858948350688157}, {"period": 85, "test_date": "2018-12", "predicted": 8384827094.034891, "actual": 7044474000.0, "error_pct": 19.02701456538687}, {"period": 86, "test_date": "2019-01", "predicted": 6848710190.62031, "actual": 7128216000.0, "error_pct": 3.921118683548453}, {"period": 87, "test_date": "2019-02", "predicted": 5542594531.911112, "actual": 4954893000.0, "error_pct": 11.86103376825921}, {"period": 88, "test_date": "2019-03", "predicted": 7592702737.056445, "actual": 7094332000.0, "error_pct": 7.024914214001334}, {"period": 89, "test_date": "2019-04", "predicted": 7277166290.198002, "actual": 6751644000.0, "error_pct": 7.783619666528654}, {"period": 90, "test_date": "2019-05", "predicted": 7750505280.972808, "actual": 7990153000.0, "error_pct": 2.999288236748309}, {"period": 91, "test_date": "2019-06", "predicted": 7771521214.654314, "actual": 7809262000.0, "error_pct": 0.4832823555629963}, {"period": 92, "test_date": "2019-07", "predicted": 7544779654.102165, "actual": 8009584000.0, "error_pct": 5.803102207278615}, {"period": 93, "test_date": "2019-08", "predicted": 7824858233.841808, "actual": 9042891000.0, "error_pct": 13.469506224925102}, {"period": 94, "test_date": "2019-09", "predicted": 8935098621.154428, "actual": 9133066000.0, "error_pct": 2.16758949125706}, {"period": 95, "test_date": "2019-10", "predicted": 8815765609.066223, "actual": 9280205000.0, "error_pct": 5.004624261358201}, {"period": 96, "test_date": "2019-11", "predicted": 9336065634.879025, "actual": 8260309000.0, "error_pct": 13.023200886056738}, {"period": 97, "test_date": "2019-12", "predicted": 8829218909.140095, "actual": 7097768000.0, "error_pct": 24.394301266822115}, {"period": 98, "test_date": "2020-01", "predicted": 7520212117.619076, "actual": 6228700000.0, "error_pct": 20.73485827891977}, {"period": 99, "test_date": "2020-02", "predicted": 5664262591.073432, "actual": 4280190000.0, "error_pct": 32.33670914313224}, {"period": 100, "test_date": "2020-03", "predicted": 7742541395.990896, "actual": 7601329000.0, "error_pct": 1.8577329831519755}, {"period": 101, "test_date": "2020-04", "predicted": 6718333777.032738, "actual": 8891424000.0, "error_pct": 24.44029463635141}, {"period": 102, "test_date": "2020-05", "predicted": 7561129392.354336, "actual": 8190663000.0, "error_pct": 7.685990836708386}, {"period": 103, "test_date": "2020-06", "predicted": 8911175013.115463, "actual": 8014033000.0, "error_pct": 11.194638368914418}, {"period": 104, "test_date": "2020-07", "predicted": 8087769830.057258, "actual": 8194616000.0, "error_pct": 1.303858166663848}, {"period": 105, "test_date": "2020-08", "predicted": 9053569987.18196, "actual": 8569027000.0, "error_pct": 5.654585837831542}, {"period": 106, "test_date": "2020-09", "predicted": 9937204448.125, "actual": 9657558000.0, "error_pct": 2.8956227663867}, {"period": 107, "test_date": "2020-10", "predicted": 8621830262.243317, "actual": 8723786000.0, "error_pct": 1.168709752356183}, {"period": 108, "test_date": "2020-11", "predicted": 8934813639.173042, "actual": 8383006000.0, "error_pct": 6.582455495952673}, {"period": 109, "test_date": "2020-12", "predicted": 8586207819.246962, "actual": 8347896000.0, "error_pct": 2.8547530928387417}, {"period": 110, "test_date": "2021-01", "predicted": 7578582322.322976, "actual": 9211314000.0, "error_pct": 17.725285205531197}, {"period": 111, "test_date": "2021-02", "predicted": 6330750075.780352, "actual": 6832174000.0, "error_pct": 7.339156236648077}, {"period": 112, "test_date": "2021-03", "predicted": 8303379440.886031, "actual": 9093560000.0, "error_pct": 8.689452305961238}, {"period": 113, "test_date": "2021-04", "predicted": 8125547105.668171, "actual": 8004716000.0, "error_pct": 1.509498971208609}, {"period": 114, "test_date": "2021-05", "predicted": 8598313332.888918, "actual": 8421571000.0, "error_pct": 2.0986860158148395}, {"period": 115, "test_date": "2021-06", "predicted": 9076080192.113, "actual": 8866488000.0, "error_pct": 2.363869348416182}, {"period": 116, "test_date": "2021-07", "predicted": 8708999741.367037, "actual": 8895088000.0, "error_pct": 2.092033925161428}, {"period": 117, "test_date": "2021-08", "predicted": 9447248446.741083, "actual": 8599800000.0, "error_pct": 9.854280875614354}, {"period": 118, "test_date": "2021-09", "predicted": 10311603700.593132, "actual": 9854024000.0, "error_pct": 4.643582160883026}, {"period": 119, "test_date": "2021-10", "predicted": 9454442554.695543, "actual": 9473418000.0, "error_pct": 0.2003019955886746}, {"period": 120, "test_date": "2021-11", "predicted": 9489329911.116064, "actual": 10317316000.0, "error_pct": 8.025208192556436}, {"period": 121, "test_date": "2021-12", "predicted": 9143075948.34789, "actual": 9994978000.0, "error_pct": 8.523300918242233}, {"period": 122, "test_date": "2022-01", "predicted": 8557833506.388295, "actual": 9928201000.0, "error_pct": 13.802777498276928}, {"period": 123, "test_date": "2022-02", "predicted": 6710234462.087288, "actual": 8313488000.0, "error_pct": 19.284968450218635}, {"period": 124, "test_date": "2022-03", "predicted": 9518723413.14902, "actual": 10603963000.0, "error_pct": 10.234283039755804}, {"period": 125, "test_date": "2022-04", "predicted": 8956054589.681017, "actual": 8060503000.0, "error_pct": 11.11036854252169}, {"period": 126, "test_date": "2022-05", "predicted": 9614234947.31313, "actual": 9863250000.0, "error_pct": 2.5246754638366724}, {"period": 127, "test_date": "2022-06", "predicted": 9860767966.099577, "actual": 10728048000.0, "error_pct": 8.08422961847694}, {"period": 128, "test_date": "2022-07", "predicted": 9597611751.284906, "actual": 10302508000.0, "error_pct": 6.841986909547594}, {"period": 129, "test_date": "2022-08", "predicted": 10340144508.676884, "actual": 10261684000.0, "error_pct": 0.7645968115650774}, {"period": 130, "test_date": "2022-09", "predicted": 11389784314.825436, "actual": 10096600000.0, "error_pct": 12.808116740540736}, {"period": 131, "test_date": "2022-10", "predicted": 10927627803.143658, "actual": 9392634000.0, "error_pct": 16.34252759283134}, {"period": 132, "test_date": "2022-11", "predicted": 10963694289.716202, "actual": 9643687000.0, "error_pct": 13.68778652517654}, {"period": 133, "test_date": "2022-12", "predicted": 10267080135.112371, "actual": 8565939000.0, "error_pct": 19.859365506949928}, {"period": 134, "test_date": "2023-01", "predicted": 9140263589.277456, "actual": 7088704000.0, "error_pct": 28.941250604870174}, {"period": 135, "test_date": "2023-02", "predicted": 7030786862.369059, "actual": 6863311000.0, "error_pct": 2.440161350244199}, {"period": 136, "test_date": "2023-03", "predicted": 10544497005.205725, "actual": 8769945000.0, "error_pct": 20.23447131316929}, {"period": 137, "test_date": "2023-04", "predicted": 8928719419.134853, "actual": 7873565000.0, "error_pct": 13.401228276325316}, {"period": 138, "test_date": "2023-05", "predicted": 10025106342.893286, "actual": 8453826000.0, "error_pct": 18.5866179750244}, {"period": 139, "test_date": "2023-06", "predicted": 9907878839.706509, "actual": 9035308000.0, "error_pct": 9.657344715935604}, {"period": 140, "test_date": "2023-07", "predicted": 9436084983.14816, "actual": 8022391000.0, "error_pct": 17.621853424348938}, {"period": 141, "test_date": "2023-08", "predicted": 9792942230.4209, "actual": 8645868000.0, "error_pct": 13.267311395696767}, {"period": 142, "test_date": "2023-09", "predicted": 10231158718.176147, "actual": 9140680000.0, "error_pct": 11.929951799823948}, {"period": 143, "test_date": "2023-10", "predicted": 10136736420.805658, "actual": 8238719000.0, "error_pct": 23.037773479173865}, {"period": 144, "test_date": "2023-11", "predicted": 10094758242.673746, "actual": 8219515000.0, "error_pct": 22.81452424715748}, {"period": 145, "test_date": "2023-12", "predicted": 9091413376.006887, "actual": 7970712000.0, "error_pct": 14.06024174511496}, {"period": 146, "test_date": "2024-01", "predicted": 7570752151.573648, "actual": 7695297000.0, "error_pct": 1.6184540821017244}, {"period": 147, "test_date": "2024-02", "predicted": 5927727942.4090605, "actual": 6640240000.0, "error_pct": 10.73021543785977}, {"period": 148, "test_date": "2024-03", "predicted": 8165381753.693738, "actual": 8510366000.0, "error_pct": 4.053694592057052}, {"period": 149, "test_date": "2024-04", "predicted": 7882979175.72237, "actual": 7762708000.0, "error_pct": 1.5493456113816229}, {"period": 150, "test_date": "2024-05", "predicted": 8139263790.494749, "actual": 8549876000.0, "error_pct": 4.802551633558791}, {"period": 151, "test_date": "2024-06", "predicted": 8722175946.437523, "actual": 8361276000.0, "error_pct": 4.316326197550743}, {"period": 152, "test_date": "2024-07", "predicted": 8327927461.88549, "actual": 8380859000.0, "error_pct": 0.6315765259206674}, {"period": 153, "test_date": "2024-08", "predicted": 8620973483.652027, "actual": 9687161000.0, "error_pct": 11.006191766070296}, {"period": 154, "test_date": "2024-09", "predicted": 9470425556.824656, "actual": 9653109000.0, "error_pct": 1.892482962487449}, {"period": 155, "test_date": "2024-10", "predicted": 8350836899.574638, "actual": 9287911000.0, "error_pct": 10.08918044569292}, {"period": 156, "test_date": "2024-11", "predicted": 8441598644.342548, "actual": 8632762000.0, "error_pct": 2.214393906115466}, {"period": 157, "test_date": "2024-12", "predicted": 8083276586.551885, "actual": 8316694000.0, "error_pct": 2.8066129816501046}, {"period": 158, "test_date": "2025-01", "predicted": 7862006095.744654, "actual": 7517508000.0, "error_pct": 4.582610297782905}, {"period": 159, "test_date": "2025-02", "predicted": 6271957560.76334, "actual": 7290720000.0, "error_pct": 13.973413314962857}, {"period": 160, "test_date": "2025-03", "predicted": 8033739096.185393, "actual": 8473057000.0, "error_pct": 5.184880779329192}, {"period": 161, "test_date": "2025-04", "predicted": 7388374824.535849, "actual": 8024350000.0, "error_pct": 7.925566251025335}, {"period": 162, "test_date": "2025-05", "predicted": 7951546919.173514, "actual": 8123837000.0, "error_pct": 2.1207968700810422}, {"period": 163, "test_date": "2025-06", "predicted": 8298252876.22985, "actual": 8346496000.0, "error_pct": 0.5780045155494016}];
                    const tbody = document.getElementById('prophet-tbody');
                    rows.forEach(r => {
                        const tr = document.createElement('tr');
                        function td(v) { const d = document.createElement('td'); d.textContent = (typeof v==='number')? v.toLocaleString(): v; d.title = v; d.className='num'; return d; }
                        tr.appendChild(td(r.period));
                        tr.appendChild(td(r.test_date));
                        tr.appendChild(td(r.predicted));
                        tr.appendChild(td(r.actual));
                        const e = td(r.error_pct);
                        e.className += (r.error_pct>=0 ? ' error-positive' : ' error-negative');
                        tr.appendChild(e);
                        tbody.appendChild(tr);
                    });
                })()
            </script>
        </div>
    
    </div>

    <script>
        // 圖表數據
        const chartData = {"periods": ["2011-12", "2012-01", "2012-02", "2012-03", "2012-04", "2012-05", "2012-06", "2012-07", "2012-08", "2012-09", "2012-10", "2012-11", "2012-12", "2013-01", "2013-02", "2013-03", "2013-04", "2013-05", "2013-06", "2013-07", "2013-08", "2013-09", "2013-10", "2013-11", "2013-12", "2014-01", "2014-02", "2014-03", "2014-04", "2014-05", "2014-06", "2014-07", "2014-08", "2014-09", "2014-10", "2014-11", "2014-12", "2015-01", "2015-02", "2015-03", "2015-04", "2015-05", "2015-06", "2015-07", "2015-08", "2015-09", "2015-10", "2015-11", "2015-12", "2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12", "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12", "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12", "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12", "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06"], "actual": [1779774000.0, 1248014000.0, 1361917000.0, 1455272000.0, 1519363000.0, 1635163000.0, 1632237000.0, 1798759000.0, 1987380000.0, 2121336000.0, 2408601000.0, 2587932000.0, 3586626000.0, 5873901000.0, 4721884000.0, 6597561000.0, 5754994000.0, 5941991000.0, 6131932000.0, 5700106000.0, 6083585000.0, 6682871000.0, 6512235000.0, 7414867000.0, 7112682000.0, 5648668000.0, 4932419000.0, 6374006000.0, 6219679000.0, 6343006000.0, 6415313000.0, 6050206000.0, 6078635000.0, 7866553000.0, 7680950000.0, 8123197000.0, 8376832000.0, 6668599000.0, 4898817000.0, 6438739000.0, 6253401000.0, 6806863000.0, 7198514000.0, 6723583000.0, 6793255000.0, 7517760000.0, 7036601000.0, 7360885000.0, 6976597000.0, 5600811000.0, 4592953000.0, 6431429000.0, 5287804000.0, 6051631000.0, 6921863000.0, 6219894000.0, 7055487000.0, 7699548000.0, 6754613000.0, 7216573000.0, 7180789000.0, 5143902000.0, 5203731000.0, 6594380000.0, 5405917000.0, 6024573000.0, 7239136000.0, 6159685000.0, 7144632000.0, 8204632000.0, 7258777000.0, 7168342000.0, 6608609000.0, 6296190000.0, 4645242000.0, 6632412000.0, 6429137000.0, 7380200000.0, 7452135000.0, 7721252000.0, 8669740000.0, 8584290000.0, 8239915000.0, 8165418000.0, 7044474000.0, 7128216000.0, 4954893000.0, 7094332000.0, 6751644000.0, 7990153000.0, 7809262000.0, 8009584000.0, 9042891000.0, 9133066000.0, 9280205000.0, 8260309000.0, 7097768000.0, 6228700000.0, 4280190000.0, 7601329000.0, 8891424000.0, 8190663000.0, 8014033000.0, 8194616000.0, 8569027000.0, 9657558000.0, 8723786000.0, 8383006000.0, 8347896000.0, 9211314000.0, 6832174000.0, 9093560000.0, 8004716000.0, 8421571000.0, 8866488000.0, 8895088000.0, 8599800000.0, 9854024000.0, 9473418000.0, 10317316000.0, 9994978000.0, 9928201000.0, 8313488000.0, 10603963000.0, 8060503000.0, 9863250000.0, 10728048000.0, 10302508000.0, 10261684000.0, 10096600000.0, 9392634000.0, 9643687000.0, 8565939000.0, 7088704000.0, 6863311000.0, 8769945000.0, 7873565000.0, 8453826000.0, 9035308000.0, 8022391000.0, 8645868000.0, 9140680000.0, 8238719000.0, 8219515000.0, 7970712000.0, 7695297000.0, 6640240000.0, 8510366000.0, 7762708000.0, 8549876000.0, 8361276000.0, 8380859000.0, 9687161000.0, 9653109000.0, 9287911000.0, 8632762000.0, 8316694000.0, 7517508000.0, 7290720000.0, 8473057000.0, 8024350000.0, 8123837000.0, 8346496000.0], "models": {"Prophet": {"predictions": [1280740619.4378948, 1586046138.893268, 561117522.9947714, 1550915675.398681, 2189730856.611112, 1735528927.1437817, 1251628384.744397, 1214009101.2922027, 1504603006.729812, 2432611142.698872, 2473830693.2810225, 3062274700.326778, 1907272847.377516, 2596088373.756127, 4089811629.770335, 5487930869.394059, 7008195691.940132, 5473472763.921561, 5404032951.945535, 6547586886.042964, 5960005361.403139, 6913589740.627511, 6712247266.408046, 7219858689.388716, 8746709403.501795, 7840426104.700977, 4974015730.262829, 6576657337.195359, 5298049540.001785, 5905013577.161407, 5924754510.556249, 5664210071.961297, 6069541751.394506, 7395098406.514104, 6921761643.947831, 8611496762.243128, 8159902772.663191, 5589062167.907922, 5848616582.704639, 7786653204.851375, 7394023239.800808, 7009343256.119253, 6896968794.082286, 6191490616.907748, 5958444373.103093, 8381802428.136128, 7990806551.899401, 9101922092.43867, 9250285830.86511, 5931538603.60922, 4863103891.813024, 6310691212.880725, 5725313667.362301, 5786212947.911183, 5996811772.952022, 5959222188.920571, 6162095697.644727, 7150707063.858178, 6622971454.575463, 6749571191.825383, 6626120100.110046, 6832208828.820733, 5186716958.698482, 6283133013.103116, 5590352494.827552, 6018414022.774128, 6432253075.580138, 6054215475.527834, 6530864583.391237, 7507851798.469116, 7067605982.820854, 7539652037.35254, 7365305193.479966, 6093464307.537715, 5174333298.306779, 6642817945.205283, 6050009011.615663, 6472788030.892595, 6992148684.037953, 6507217240.919819, 7023588480.937802, 8436342422.587008, 7998111991.34116, 8562171443.237794, 8384827094.034891, 6848710190.62031, 5542594531.911112, 7592702737.056445, 7277166290.198002, 7750505280.972808, 7771521214.654314, 7544779654.102165, 7824858233.841808, 8935098621.154428, 8815765609.066223, 9336065634.879025, 8829218909.140095, 7520212117.619076, 5664262591.073432, 7742541395.990896, 6718333777.032738, 7561129392.354336, 8911175013.115463, 8087769830.057258, 9053569987.18196, 9937204448.125, 8621830262.243317, 8934813639.173042, 8586207819.246962, 7578582322.322976, 6330750075.780352, 8303379440.886031, 8125547105.668171, 8598313332.888918, 9076080192.113, 8708999741.367037, 9447248446.741083, 10311603700.593132, 9454442554.695543, 9489329911.116064, 9143075948.34789, 8557833506.388295, 6710234462.087288, 9518723413.14902, 8956054589.681017, 9614234947.31313, 9860767966.099577, 9597611751.284906, 10340144508.676884, 11389784314.825436, 10927627803.143658, 10963694289.716202, 10267080135.112371, 9140263589.277456, 7030786862.369059, 10544497005.205725, 8928719419.134853, 10025106342.893286, 9907878839.706509, 9436084983.14816, 9792942230.4209, 10231158718.176147, 10136736420.805658, 10094758242.673746, 9091413376.006887, 7570752151.573648, 5927727942.4090605, 8165381753.693738, 7882979175.72237, 8139263790.494749, 8722175946.437523, 8327927461.88549, 8620973483.652027, 9470425556.824656, 8350836899.574638, 8441598644.342548, 8083276586.551885, 7862006095.744654, 6271957560.76334, 8033739096.185393, 7388374824.535849, 7951546919.173514, 8298252876.22985]}}};

        // 初始化圖表
        initializeCharts();

        function showTab(tabName) {
            // 隱藏所有內容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 顯示選中的內容
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // 重新渲染圖表（Plotly需要）
            setTimeout(() => {
                Plotly.Plots.resize();
            }, 100);
        }

        function initializeCharts() {
            // 總覽對比圖
            createComparisonChart();

            // 各模型詳細圖
            createModelChart('Prophet');
        }

        function createComparisonChart() {
            const traces = [];

            // 實際值（只需要一條線）
            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            // 各模型預測值
            const colors = ['#A23B72', '#F18F01', '#C73E1D', '#7209B7'];
            let colorIndex = 0;

            Object.keys(chartData.models).forEach(modelName => {
                const modelData = chartData.models[modelName];
                traces.push({
                    x: chartData.periods,
                    y: modelData.predictions,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `${modelName} 預測`,
                    line: { color: colors[colorIndex % colors.length], width: 2, dash: 'dot' },
                    marker: { size: 4 }
                });
                colorIndex++;
            });

            const layout = {
                title: '所有模型預測對比',
                xaxis: { title: '回測期數' },
                yaxis: {
                    title: '營收 (億元)',
                    tickformat: '.1f'
                },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };

            Plotly.newPlot('comparison-chart', traces, layout, {responsive: true});
        }

        
        function createModelChart(modelName) {
            const divId = modelName.toLowerCase() + '-chart';
            const preds = chartData.models[modelName]?.predictions || [];
            const traces = [];

            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual.map(v => v/1e8),
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            traces.push({
                x: chartData.periods,
                y: preds.map(v => v/1e8),
                type: 'scatter',
                mode: 'lines+markers',
                name: modelName + ' 預測',
                line: { color: '#A23B72', width: 2, dash: 'dot' },
                marker: { size: 4 }
            });

            const layout = {
                title: modelName + ' 模型：預測 vs 實際',
                xaxis: { title: '回測年月' },
                yaxis: { title: '營收 (億元)' },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };
            Plotly.newPlot(divId, traces, layout, {responsive: true});
        }
    
    </script>
</body>
</html>