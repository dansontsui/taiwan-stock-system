<!DOCTYPE html>
<html lang='zh-Hant'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>8299 互動式回測分析</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #e9ecef;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .tab:hover {
            background: #dee2e6;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #667eea;
            color: #667eea;
        }
        .tab-content {
            display: none;
            padding: 30px;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }
        .model-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #dee2e6;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:hover {
            background: #f1f7ff;
        }
        .num {
            font-variant-numeric: tabular-nums;
        }
        .error-positive {
            color: #dc3545;
        }
        .error-negative {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>8299 互動式回測分析</h1>
            <p>所有模型的預測表現與詳細歷史</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">📊 總覽</button>
            <button class="tab" onclick="showTab('prophet')">📐 Prophet (誤差率: 0.0%)</button>
        </div>

        <!-- 總覽頁面 -->
        <div id="overview" class="tab-content active">
            <h2>📈 所有模型預測對比</h2>
            <div class="chart-container">
                <div id="comparison-chart" style="height: 600px;"></div>
            </div>

            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">Prophet 誤差率(MAPE)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">Prophet 趨勢準確率</div>
                </div>
            </div>
        </div>
        <div id="prophet" class="tab-content">
            <h2>📐 Prophet 詳細分析</h2>
            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">誤差率(MAPE)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">趨勢準確率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">152</div>
                    <div class="stat-label">回測次數</div>
                </div>
            </div>
            <div class="chart-container">
                <div id="prophet-chart" style="height: 500px;"></div>
            </div>
            <h3>詳細回測歷史</h3>
            <div style="max-height: 400px; overflow: auto; border: 1px solid #eee;">
                <table>
                    <thead>
                        <tr>
                            <th>期數</th>
                            <th>回測年月</th>
                            <th>預測數據</th>
                            <th>實際數據</th>
                            <th>誤差(%)</th>
                        </tr>
                    </thead>
                    <tbody id="prophet-tbody"></tbody>
                </table>
            </div>
            <script>
                (function() {
                    const rows = [{"period": 1, "test_date": "2012-12", "predicted": 2566453755.001008, "actual": 2435207000.0, "error_pct": 5.389552305040498}, {"period": 2, "test_date": "2013-01", "predicted": 2705065467.393144, "actual": 2379656000.0, "error_pct": 13.674643200241702}, {"period": 3, "test_date": "2013-02", "predicted": 2357288829.018027, "actual": 1904292000.0, "error_pct": 23.788202072897796}, {"period": 4, "test_date": "2013-03", "predicted": 3187842806.164132, "actual": 2829897000.0, "error_pct": 12.648722061761667}, {"period": 5, "test_date": "2013-04", "predicted": 2762424205.7011924, "actual": 2655632000.0, "error_pct": 4.021348052034031}, {"period": 6, "test_date": "2013-05", "predicted": 2404446529.573837, "actual": 3021958000.0, "error_pct": 20.43415131600648}, {"period": 7, "test_date": "2013-06", "predicted": 2631894565.36112, "actual": 2620416000.0, "error_pct": 0.438043629756487}, {"period": 8, "test_date": "2013-07", "predicted": 2962542310.2750244, "actual": 3032704000.0, "error_pct": 2.313502726443978}, {"period": 9, "test_date": "2013-08", "predicted": 2835850112.25426, "actual": 2678439000.0, "error_pct": 5.876972081658742}, {"period": 10, "test_date": "2013-09", "predicted": 2821107086.4022, "actual": 2688611000.0, "error_pct": 4.928049703069735}, {"period": 11, "test_date": "2013-10", "predicted": 2996706743.4227924, "actual": 2986999000.0, "error_pct": 0.3249998886103555}, {"period": 12, "test_date": "2013-11", "predicted": 2857201678.813581, "actual": 2839349000.0, "error_pct": 0.628759578818278}, {"period": 13, "test_date": "2013-12", "predicted": 2482146035.326707, "actual": 2536378000.0, "error_pct": 2.1381657100516214}, {"period": 14, "test_date": "2014-01", "predicted": 2545369991.936436, "actual": 2624079000.0, "error_pct": 2.9994907951919063}, {"period": 15, "test_date": "2014-02", "predicted": 2245749837.85491, "actual": 2367984000.0, "error_pct": 5.161950509171096}, {"period": 16, "test_date": "2014-03", "predicted": 3130034661.6379647, "actual": 2709271000.0, "error_pct": 15.530512142859267}, {"period": 17, "test_date": "2014-04", "predicted": 2764915533.363097, "actual": 2594411000.0, "error_pct": 6.571993927064647}, {"period": 18, "test_date": "2014-05", "predicted": 2564290289.232276, "actual": 2770956000.0, "error_pct": 7.458281934744688}, {"period": 19, "test_date": "2014-06", "predicted": 2628090247.0631843, "actual": 2722511000.0, "error_pct": 3.4681495478554814}, {"period": 20, "test_date": "2014-07", "predicted": 2989943054.8642025, "actual": 3049473000.0, "error_pct": 1.9521387838422408}, {"period": 21, "test_date": "2014-08", "predicted": 2802793898.0615416, "actual": 2789293000.0, "error_pct": 0.484025810896939}, {"period": 22, "test_date": "2014-09", "predicted": 2807514672.4685206, "actual": 2678980000.0, "error_pct": 4.7978959330984425}, {"period": 23, "test_date": "2014-10", "predicted": 3015254923.4488115, "actual": 3120819000.0, "error_pct": 3.382576065807997}, {"period": 24, "test_date": "2014-11", "predicted": 2860845203.5911465, "actual": 2911902000.0, "error_pct": 1.753383060585608}, {"period": 25, "test_date": "2014-12", "predicted": 2508413326.6374936, "actual": 2735019000.0, "error_pct": 8.285341833548738}, {"period": 26, "test_date": "2015-01", "predicted": 2574746010.1313634, "actual": 2843731000.0, "error_pct": 9.458876028310575}, {"period": 27, "test_date": "2015-02", "predicted": 2338480017.656834, "actual": 2631357000.0, "error_pct": 11.130264055510745}, {"period": 28, "test_date": "2015-03", "predicted": 3087276151.399909, "actual": 2866389000.0, "error_pct": 7.706112164116909}, {"period": 29, "test_date": "2015-04", "predicted": 2791564729.811657, "actual": 2889796000.0, "error_pct": 3.39924583563487}, {"period": 30, "test_date": "2015-05", "predicted": 2665018639.362725, "actual": 2811290000.0, "error_pct": 5.202997934659008}, {"period": 31, "test_date": "2015-06", "predicted": 2720786635.760013, "actual": 2741071000.0, "error_pct": 0.7400160098000708}, {"period": 32, "test_date": "2015-07", "predicted": 3071387094.006591, "actual": 3317290000.0, "error_pct": 7.41276481686585}, {"period": 33, "test_date": "2015-08", "predicted": 2874763753.094821, "actual": 3225471000.0, "error_pct": 10.873055343085662}, {"period": 34, "test_date": "2015-09", "predicted": 2871425320.098681, "actual": 3491055000.0, "error_pct": 17.749066683318336}, {"period": 35, "test_date": "2015-10", "predicted": 3151474761.978155, "actual": 4170476000.0, "error_pct": 24.43369145444896}, {"period": 36, "test_date": "2015-11", "predicted": 2997653443.3298383, "actual": 3227037000.0, "error_pct": 7.108178699846383}, {"period": 37, "test_date": "2015-12", "predicted": 2712252763.417476, "actual": 2963140000.0, "error_pct": 8.466938335094657}, {"period": 38, "test_date": "2016-01", "predicted": 2778660992.8385954, "actual": 3120529000.0, "error_pct": 10.955450411177226}, {"period": 39, "test_date": "2016-02", "predicted": 2598015801.9911184, "actual": 3091855000.0, "error_pct": 15.972262541706566}, {"period": 40, "test_date": "2016-03", "predicted": 3279031101.757982, "actual": 3694002000.0, "error_pct": 11.233640324017644}, {"period": 41, "test_date": "2016-04", "predicted": 3014401614.939042, "actual": 3835798000.0, "error_pct": 21.413963536686705}, {"period": 42, "test_date": "2016-05", "predicted": 2958369813.7641377, "actual": 3190326000.0, "error_pct": 7.270610785100402}, {"period": 43, "test_date": "2016-06", "predicted": 2961661326.9169044, "actual": 3430814000.0, "error_pct": 13.674675254417624}, {"period": 44, "test_date": "2016-07", "predicted": 3360178952.451618, "actual": 3788741000.0, "error_pct": 11.311463294756274}, {"period": 45, "test_date": "2016-08", "predicted": 3195825939.097983, "actual": 4445990000.0, "error_pct": 28.118913018293277}, {"period": 46, "test_date": "2016-09", "predicted": 3250661618.897887, "actual": 4102626000.0, "error_pct": 20.766318477533968}, {"period": 47, "test_date": "2016-10", "predicted": 3589043728.1666813, "actual": 4176802000.0, "error_pct": 14.071968741475386}, {"period": 48, "test_date": "2016-11", "predicted": 3365739905.3114142, "actual": 3837687000.0, "error_pct": 12.297696364726612}, {"period": 49, "test_date": "2016-12", "predicted": 3104875548.780097, "actual": 3067342000.0, "error_pct": 1.2236505997732725}, {"period": 50, "test_date": "2017-01", "predicted": 3196170619.400966, "actual": 3147077000.0, "error_pct": 1.5599751579311905}, {"period": 51, "test_date": "2017-02", "predicted": 2898192884.5078, "actual": 2779274000.0, "error_pct": 4.278775122848615}, {"period": 52, "test_date": "2017-03", "predicted": 3615001817.2284775, "actual": 3629516000.0, "error_pct": 0.3998930648472833}, {"period": 53, "test_date": "2017-04", "predicted": 3422169413.659592, "actual": 3356656000.0, "error_pct": 1.951746430363795}, {"period": 54, "test_date": "2017-05", "predicted": 3235589908.138424, "actual": 3492154000.0, "error_pct": 7.346872213011685}, {"period": 55, "test_date": "2017-06", "predicted": 3282188992.8968573, "actual": 3643683000.0, "error_pct": 9.921115725576092}, {"period": 56, "test_date": "2017-07", "predicted": 3674606689.510553, "actual": 3627165000.0, "error_pct": 1.3079550974536005}, {"period": 57, "test_date": "2017-08", "predicted": 3622219243.439234, "actual": 3606489000.0, "error_pct": 0.4361650191982911}, {"period": 58, "test_date": "2017-09", "predicted": 3586571084.688958, "actual": 3939973000.0, "error_pct": 8.969653226330266}, {"period": 59, "test_date": "2017-10", "predicted": 3882033780.939295, "actual": 3741271000.0, "error_pct": 3.762432096987757}, {"period": 60, "test_date": "2017-11", "predicted": 3599152069.8945503, "actual": 3896275000.0, "error_pct": 7.625820305431461}, {"period": 61, "test_date": "2017-12", "predicted": 3259084071.461607, "actual": 3005226000.0, "error_pct": 8.4472206570024}, {"period": 62, "test_date": "2018-01", "predicted": 3335852310.903017, "actual": 3065076000.0, "error_pct": 8.83424459631727}, {"period": 63, "test_date": "2018-02", "predicted": 3057670576.77897, "actual": 2731663000.0, "error_pct": 11.934399549979984}, {"period": 64, "test_date": "2018-03", "predicted": 3739488647.521724, "actual": 3502814000.0, "error_pct": 6.756700399214009}, {"period": 65, "test_date": "2018-04", "predicted": 3580532356.2730184, "actual": 3518011000.0, "error_pct": 1.7771791012881528}, {"period": 66, "test_date": "2018-05", "predicted": 3458659702.289073, "actual": 3459047000.0, "error_pct": 0.0111966593956951}, {"period": 67, "test_date": "2018-06", "predicted": 3488809842.9633617, "actual": 3352088000.0, "error_pct": 4.078706852665018}, {"period": 68, "test_date": "2018-07", "predicted": 3778478138.0864544, "actual": 3569800000.0, "error_pct": 5.845653484409614}, {"period": 69, "test_date": "2018-08", "predicted": 3787362741.232326, "actual": 3905980000.0, "error_pct": 3.0368117288791536}, {"period": 70, "test_date": "2018-09", "predicted": 3763901790.348164, "actual": 3561053000.0, "error_pct": 5.696314835756842}, {"period": 71, "test_date": "2018-10", "predicted": 4017896325.833557, "actual": 3606644000.0, "error_pct": 11.402631527635029}, {"period": 72, "test_date": "2018-11", "predicted": 3778424259.195281, "actual": 3554055000.0, "error_pct": 6.313049719131556}, {"period": 73, "test_date": "2018-12", "predicted": 3362419688.032511, "actual": 2961874000.0, "error_pct": 13.523387153961014}, {"period": 74, "test_date": "2019-01", "predicted": 3342834245.733065, "actual": 3358464000.0, "error_pct": 0.4653840049181671}, {"period": 75, "test_date": "2019-02", "predicted": 3131531891.919542, "actual": 2710307000.0, "error_pct": 15.541593329447249}, {"period": 76, "test_date": "2019-03", "predicted": 3777107847.957508, "actual": 3274245000.0, "error_pct": 15.358131354175026}, {"period": 77, "test_date": "2019-04", "predicted": 3572066869.39866, "actual": 3084400000.0, "error_pct": 15.810753125361812}, {"period": 78, "test_date": "2019-05", "predicted": 3405763770.7180824, "actual": 3355208000.0, "error_pct": 1.5067849956867778}, {"period": 79, "test_date": "2019-06", "predicted": 3519679121.6718965, "actual": 3343520000.0, "error_pct": 5.268672586731841}, {"period": 80, "test_date": "2019-07", "predicted": 3820362222.0767326, "actual": 4062819000.0, "error_pct": 5.9676982391602325}, {"period": 81, "test_date": "2019-08", "predicted": 3836559559.8987, "actual": 4272747000.0, "error_pct": 10.208595081836105}, {"period": 82, "test_date": "2019-09", "predicted": 3779626973.701602, "actual": 4058337000.0, "error_pct": 6.867591979138204}, {"period": 83, "test_date": "2019-10", "predicted": 4032656625.941105, "actual": 4697324000.0, "error_pct": 14.14991544247097}, {"period": 84, "test_date": "2019-11", "predicted": 3801228838.120049, "actual": 4380889000.0, "error_pct": 13.231564686527127}, {"period": 85, "test_date": "2019-12", "predicted": 3417649678.066066, "actual": 4095181000.0, "error_pct": 16.544600151591204}, {"period": 86, "test_date": "2020-01", "predicted": 3560978806.806536, "actual": 3325942000.0, "error_pct": 7.066774069016724}, {"period": 87, "test_date": "2020-02", "predicted": 3195476761.001755, "actual": 4001968000.0, "error_pct": 20.152366010878765}, {"period": 88, "test_date": "2020-03", "predicted": 3939405785.808719, "actual": 5538793000.0, "error_pct": 28.87609654650897}, {"period": 89, "test_date": "2020-04", "predicted": 3812270517.3317857, "actual": 3579202000.0, "error_pct": 6.511745280981226}, {"period": 90, "test_date": "2020-05", "predicted": 3663561281.1033664, "actual": 3905092000.0, "error_pct": 6.185019940545155}, {"period": 91, "test_date": "2020-06", "predicted": 3788484407.440033, "actual": 3370555000.0, "error_pct": 12.399424054496452}, {"period": 92, "test_date": "2020-07", "predicted": 4078494964.6647086, "actual": 3849067000.0, "error_pct": 5.960612394242776}, {"period": 93, "test_date": "2020-08", "predicted": 4130639764.6739817, "actual": 3743807000.0, "error_pct": 10.33260434295843}, {"period": 94, "test_date": "2020-09", "predicted": 4046337574.149162, "actual": 4341123000.0, "error_pct": 6.79053382847798}, {"period": 95, "test_date": "2020-10", "predicted": 4298764203.676152, "actual": 4447850000.0, "error_pct": 3.3518620529884724}, {"period": 96, "test_date": "2020-11", "predicted": 4093070756.35789, "actual": 4218291000.0, "error_pct": 2.968506526508244}, {"period": 97, "test_date": "2020-12", "predicted": 3669389186.185317, "actual": 4174832000.0, "error_pct": 12.106901878079954}, {"period": 98, "test_date": "2021-01", "predicted": 3732688780.769083, "actual": 4060743000.0, "error_pct": 8.078674745752611}, {"period": 99, "test_date": "2021-02", "predicted": 3555607180.053878, "actual": 3654613000.0, "error_pct": 2.7090644056189306}, {"period": 100, "test_date": "2021-03", "predicted": 4239944303.145609, "actual": 5172594000.0, "error_pct": 18.030599286439088}, {"period": 101, "test_date": "2021-04", "predicted": 3975954487.660984, "actual": 5090578000.0, "error_pct": 21.89581443087633}, {"period": 102, "test_date": "2021-05", "predicted": 3940435570.966757, "actual": 5696048000.0, "error_pct": 30.821587687344675}, {"period": 103, "test_date": "2021-06", "predicted": 3896667561.869468, "actual": 5123350000.0, "error_pct": 23.94297555565269}, {"period": 104, "test_date": "2021-07", "predicted": 4343273804.827467, "actual": 5482184000.0, "error_pct": 20.774753185455523}, {"period": 105, "test_date": "2021-08", "predicted": 4345618390.999422, "actual": 5706563000.0, "error_pct": 23.848761662678186}, {"period": 106, "test_date": "2021-09", "predicted": 4406299421.229791, "actual": 5737799000.0, "error_pct": 23.2057550076294}, {"period": 107, "test_date": "2021-10", "predicted": 4692075639.5150585, "actual": 6036781000.0, "error_pct": 22.275205287137982}, {"period": 108, "test_date": "2021-11", "predicted": 4479298630.347019, "actual": 5802942000.0, "error_pct": 22.809867299259253}, {"period": 109, "test_date": "2021-12", "predicted": 4132348915.542934, "actual": 4992997000.0, "error_pct": 17.23710397697147}, {"period": 110, "test_date": "2022-01", "predicted": 4256303764.557196, "actual": 5418890000.0, "error_pct": 21.45432432551323}, {"period": 111, "test_date": "2022-02", "predicted": 4025121879.201552, "actual": 5307336000.0, "error_pct": 24.159279171291363}, {"period": 112, "test_date": "2022-03", "predicted": 4908789350.283537, "actual": 6379633000.0, "error_pct": 23.055301922798115}, {"period": 113, "test_date": "2022-04", "predicted": 4531767478.131093, "actual": 5901725000.0, "error_pct": 23.21283221208896}, {"period": 114, "test_date": "2022-05", "predicted": 4571979424.697652, "actual": 5099437000.0, "error_pct": 10.343447233534764}, {"period": 115, "test_date": "2022-06", "predicted": 4537548829.882217, "actual": 5284253000.0, "error_pct": 14.130742228235146}, {"period": 116, "test_date": "2022-07", "predicted": 4921425396.759194, "actual": 5342363000.0, "error_pct": 7.879240014967265}, {"period": 117, "test_date": "2022-08", "predicted": 4964150994.277799, "actual": 4423361000.0, "error_pct": 12.225771178924774}, {"period": 118, "test_date": "2022-09", "predicted": 4927255528.5046215, "actual": 4808884000.0, "error_pct": 2.461517651592792}, {"period": 119, "test_date": "2022-10", "predicted": 5138615781.76287, "actual": 4205901000.0, "error_pct": 22.17633705032215}, {"period": 120, "test_date": "2022-11", "predicted": 4878109741.675886, "actual": 4082304000.0, "error_pct": 19.494034292298814}, {"period": 121, "test_date": "2022-12", "predicted": 4510038922.6762295, "actual": 4002055000.0, "error_pct": 12.693076998597707}, {"period": 122, "test_date": "2023-01", "predicted": 4518823419.135959, "actual": 2878167000.0, "error_pct": 57.00351713906658}, {"period": 123, "test_date": "2023-02", "predicted": 4296034457.911663, "actual": 3274873000.0, "error_pct": 31.181711715589067}, {"period": 124, "test_date": "2023-03", "predicted": 5083607765.045905, "actual": 3925381000.0, "error_pct": 29.50609800796165}, {"period": 125, "test_date": "2023-04", "predicted": 4727263538.656574, "actual": 3366959000.0, "error_pct": 40.40157716968262}, {"period": 126, "test_date": "2023-05", "predicted": 4654365745.703552, "actual": 3201684000.0, "error_pct": 45.37242731336235}, {"period": 127, "test_date": "2023-06", "predicted": 4594677790.049205, "actual": 3438001000.0, "error_pct": 33.64387590489953}, {"period": 128, "test_date": "2023-07", "predicted": 4904793677.431868, "actual": 3394299000.0, "error_pct": 44.50093163365595}, {"period": 129, "test_date": "2023-08", "predicted": 4774602996.185684, "actual": 3990403000.0, "error_pct": 19.65215032631251}, {"period": 130, "test_date": "2023-09", "predicted": 4869730271.895617, "actual": 5003863000.0, "error_pct": 2.6805835432421605}, {"period": 131, "test_date": "2023-10", "predicted": 5136286267.590193, "actual": 5158905000.0, "error_pct": 0.4384405684889954}, {"period": 132, "test_date": "2023-11", "predicted": 4818095811.624247, "actual": 5407270000.0, "error_pct": 10.895963922196476}, {"period": 133, "test_date": "2023-12", "predicted": 4513631227.496202, "actual": 5181825000.0, "error_pct": 12.894950572506744}, {"period": 134, "test_date": "2024-01", "predicted": 4554364596.206192, "actual": 5086003000.0, "error_pct": 10.452970707917553}, {"period": 135, "test_date": "2024-02", "predicted": 4404752695.0447855, "actual": 4664908000.0, "error_pct": 5.576858213607096}, {"period": 136, "test_date": "2024-03", "predicted": 5073277444.663102, "actual": 6774966000.0, "error_pct": 25.117300298435413}, {"period": 137, "test_date": "2024-04", "predicted": 4835130608.298689, "actual": 5156193000.0, "error_pct": 6.226733400035862}, {"period": 138, "test_date": "2024-05", "predicted": 4822644827.630595, "actual": 5377566000.0, "error_pct": 10.319188502184906}, {"period": 139, "test_date": "2024-06", "predicted": 4740657034.372113, "actual": 5361009000.0, "error_pct": 11.571552400450862}, {"period": 140, "test_date": "2024-07", "predicted": 5161295389.88661, "actual": 4706092000.0, "error_pct": 9.672641118928617}, {"period": 141, "test_date": "2024-08", "predicted": 4966351690.851674, "actual": 4805588000.0, "error_pct": 3.345349015597552}, {"period": 142, "test_date": "2024-09", "predicted": 5106604876.185395, "actual": 4430879000.0, "error_pct": 15.250379804670706}, {"period": 143, "test_date": "2024-10", "predicted": 5342580699.961146, "actual": 3717027000.0, "error_pct": 43.732630942986056}, {"period": 144, "test_date": "2024-11", "predicted": 5118796172.583145, "actual": 4333904000.0, "error_pct": 18.11051127535693}, {"period": 145, "test_date": "2024-12", "predicted": 4658955780.267312, "actual": 4521378000.0, "error_pct": 3.0428285418142886}, {"period": 146, "test_date": "2025-01", "predicted": 4658874306.311318, "actual": 3613390000.0, "error_pct": 28.933613761905537}, {"period": 147, "test_date": "2025-02", "predicted": 4357650810.295283, "actual": 4527416000.0, "error_pct": 3.749714841859389}, {"period": 148, "test_date": "2025-03", "predicted": 5363345182.149759, "actual": 5697759000.0, "error_pct": 5.869216613939633}, {"period": 149, "test_date": "2025-04", "predicted": 5024988463.451786, "actual": 6002833000.0, "error_pct": 16.28971748086635}, {"period": 150, "test_date": "2025-05", "predicted": 4944893451.783006, "actual": 5689559000.0, "error_pct": 13.088282382114224}, {"period": 151, "test_date": "2025-06", "predicted": 4888284993.5902605, "actual": 6197679000.0, "error_pct": 21.127167225178}, {"period": 152, "test_date": "2025-07", "predicted": 5237327064.700769, "actual": 5687708000.0, "error_pct": 7.918496084876906}];
                    const tbody = document.getElementById('prophet-tbody');
                    rows.forEach(r => {
                        const tr = document.createElement('tr');
                        function td(v) { const d = document.createElement('td'); d.textContent = (typeof v==='number')? v.toLocaleString(): v; d.title = v; d.className='num'; return d; }
                        tr.appendChild(td(r.period));
                        tr.appendChild(td(r.test_date));
                        tr.appendChild(td(r.predicted));
                        tr.appendChild(td(r.actual));
                        const e = td(r.error_pct);
                        e.className += (r.error_pct>=0 ? ' error-positive' : ' error-negative');
                        tr.appendChild(e);
                        tbody.appendChild(tr);
                    });
                })()
            </script>
        </div>
    
    </div>

    <script>
        // 圖表數據
        const chartData = {"periods": ["2012-12", "2013-01", "2013-02", "2013-03", "2013-04", "2013-05", "2013-06", "2013-07", "2013-08", "2013-09", "2013-10", "2013-11", "2013-12", "2014-01", "2014-02", "2014-03", "2014-04", "2014-05", "2014-06", "2014-07", "2014-08", "2014-09", "2014-10", "2014-11", "2014-12", "2015-01", "2015-02", "2015-03", "2015-04", "2015-05", "2015-06", "2015-07", "2015-08", "2015-09", "2015-10", "2015-11", "2015-12", "2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12", "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12", "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12", "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12", "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06", "2025-07"], "actual": [2435207000.0, 2379656000.0, 1904292000.0, 2829897000.0, 2655632000.0, 3021958000.0, 2620416000.0, 3032704000.0, 2678439000.0, 2688611000.0, 2986999000.0, 2839349000.0, 2536378000.0, 2624079000.0, 2367984000.0, 2709271000.0, 2594411000.0, 2770956000.0, 2722511000.0, 3049473000.0, 2789293000.0, 2678980000.0, 3120819000.0, 2911902000.0, 2735019000.0, 2843731000.0, 2631357000.0, 2866389000.0, 2889796000.0, 2811290000.0, 2741071000.0, 3317290000.0, 3225471000.0, 3491055000.0, 4170476000.0, 3227037000.0, 2963140000.0, 3120529000.0, 3091855000.0, 3694002000.0, 3835798000.0, 3190326000.0, 3430814000.0, 3788741000.0, 4445990000.0, 4102626000.0, 4176802000.0, 3837687000.0, 3067342000.0, 3147077000.0, 2779274000.0, 3629516000.0, 3356656000.0, 3492154000.0, 3643683000.0, 3627165000.0, 3606489000.0, 3939973000.0, 3741271000.0, 3896275000.0, 3005226000.0, 3065076000.0, 2731663000.0, 3502814000.0, 3518011000.0, 3459047000.0, 3352088000.0, 3569800000.0, 3905980000.0, 3561053000.0, 3606644000.0, 3554055000.0, 2961874000.0, 3358464000.0, 2710307000.0, 3274245000.0, 3084400000.0, 3355208000.0, 3343520000.0, 4062819000.0, 4272747000.0, 4058337000.0, 4697324000.0, 4380889000.0, 4095181000.0, 3325942000.0, 4001968000.0, 5538793000.0, 3579202000.0, 3905092000.0, 3370555000.0, 3849067000.0, 3743807000.0, 4341123000.0, 4447850000.0, 4218291000.0, 4174832000.0, 4060743000.0, 3654613000.0, 5172594000.0, 5090578000.0, 5696048000.0, 5123350000.0, 5482184000.0, 5706563000.0, 5737799000.0, 6036781000.0, 5802942000.0, 4992997000.0, 5418890000.0, 5307336000.0, 6379633000.0, 5901725000.0, 5099437000.0, 5284253000.0, 5342363000.0, 4423361000.0, 4808884000.0, 4205901000.0, 4082304000.0, 4002055000.0, 2878167000.0, 3274873000.0, 3925381000.0, 3366959000.0, 3201684000.0, 3438001000.0, 3394299000.0, 3990403000.0, 5003863000.0, 5158905000.0, 5407270000.0, 5181825000.0, 5086003000.0, 4664908000.0, 6774966000.0, 5156193000.0, 5377566000.0, 5361009000.0, 4706092000.0, 4805588000.0, 4430879000.0, 3717027000.0, 4333904000.0, 4521378000.0, 3613390000.0, 4527416000.0, 5697759000.0, 6002833000.0, 5689559000.0, 6197679000.0, 5687708000.0], "models": {"Prophet": {"predictions": [2566453755.001008, 2705065467.393144, 2357288829.018027, 3187842806.164132, 2762424205.7011924, 2404446529.573837, 2631894565.36112, 2962542310.2750244, 2835850112.25426, 2821107086.4022, 2996706743.4227924, 2857201678.813581, 2482146035.326707, 2545369991.936436, 2245749837.85491, 3130034661.6379647, 2764915533.363097, 2564290289.232276, 2628090247.0631843, 2989943054.8642025, 2802793898.0615416, 2807514672.4685206, 3015254923.4488115, 2860845203.5911465, 2508413326.6374936, 2574746010.1313634, 2338480017.656834, 3087276151.399909, 2791564729.811657, 2665018639.362725, 2720786635.760013, 3071387094.006591, 2874763753.094821, 2871425320.098681, 3151474761.978155, 2997653443.3298383, 2712252763.417476, 2778660992.8385954, 2598015801.9911184, 3279031101.757982, 3014401614.939042, 2958369813.7641377, 2961661326.9169044, 3360178952.451618, 3195825939.097983, 3250661618.897887, 3589043728.1666813, 3365739905.3114142, 3104875548.780097, 3196170619.400966, 2898192884.5078, 3615001817.2284775, 3422169413.659592, 3235589908.138424, 3282188992.8968573, 3674606689.510553, 3622219243.439234, 3586571084.688958, 3882033780.939295, 3599152069.8945503, 3259084071.461607, 3335852310.903017, 3057670576.77897, 3739488647.521724, 3580532356.2730184, 3458659702.289073, 3488809842.9633617, 3778478138.0864544, 3787362741.232326, 3763901790.348164, 4017896325.833557, 3778424259.195281, 3362419688.032511, 3342834245.733065, 3131531891.919542, 3777107847.957508, 3572066869.39866, 3405763770.7180824, 3519679121.6718965, 3820362222.0767326, 3836559559.8987, 3779626973.701602, 4032656625.941105, 3801228838.120049, 3417649678.066066, 3560978806.806536, 3195476761.001755, 3939405785.808719, 3812270517.3317857, 3663561281.1033664, 3788484407.440033, 4078494964.6647086, 4130639764.6739817, 4046337574.149162, 4298764203.676152, 4093070756.35789, 3669389186.185317, 3732688780.769083, 3555607180.053878, 4239944303.145609, 3975954487.660984, 3940435570.966757, 3896667561.869468, 4343273804.827467, 4345618390.999422, 4406299421.229791, 4692075639.5150585, 4479298630.347019, 4132348915.542934, 4256303764.557196, 4025121879.201552, 4908789350.283537, 4531767478.131093, 4571979424.697652, 4537548829.882217, 4921425396.759194, 4964150994.277799, 4927255528.5046215, 5138615781.76287, 4878109741.675886, 4510038922.6762295, 4518823419.135959, 4296034457.911663, 5083607765.045905, 4727263538.656574, 4654365745.703552, 4594677790.049205, 4904793677.431868, 4774602996.185684, 4869730271.895617, 5136286267.590193, 4818095811.624247, 4513631227.496202, 4554364596.206192, 4404752695.0447855, 5073277444.663102, 4835130608.298689, 4822644827.630595, 4740657034.372113, 5161295389.88661, 4966351690.851674, 5106604876.185395, 5342580699.961146, 5118796172.583145, 4658955780.267312, 4658874306.311318, 4357650810.295283, 5363345182.149759, 5024988463.451786, 4944893451.783006, 4888284993.5902605, 5237327064.700769]}}};

        // 初始化圖表
        initializeCharts();

        function showTab(tabName) {
            // 隱藏所有內容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 顯示選中的內容
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // 重新渲染圖表（Plotly需要）
            setTimeout(() => {
                Plotly.Plots.resize();
            }, 100);
        }

        function initializeCharts() {
            // 總覽對比圖
            createComparisonChart();

            // 各模型詳細圖
            createModelChart('Prophet');
        }

        function createComparisonChart() {
            const traces = [];

            // 實際值（只需要一條線）
            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            // 各模型預測值
            const colors = ['#A23B72', '#F18F01', '#C73E1D', '#7209B7'];
            let colorIndex = 0;

            Object.keys(chartData.models).forEach(modelName => {
                const modelData = chartData.models[modelName];
                traces.push({
                    x: chartData.periods,
                    y: modelData.predictions,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `${modelName} 預測`,
                    line: { color: colors[colorIndex % colors.length], width: 2, dash: 'dot' },
                    marker: { size: 4 }
                });
                colorIndex++;
            });

            const layout = {
                title: '所有模型預測對比',
                xaxis: { title: '回測期數' },
                yaxis: {
                    title: '營收 (億元)',
                    tickformat: '.1f'
                },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };

            Plotly.newPlot('comparison-chart', traces, layout, {responsive: true});
        }

        
        function createModelChart(modelName) {
            const divId = modelName.toLowerCase() + '-chart';
            const preds = chartData.models[modelName]?.predictions || [];
            const traces = [];

            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual.map(v => v/1e8),
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            traces.push({
                x: chartData.periods,
                y: preds.map(v => v/1e8),
                type: 'scatter',
                mode: 'lines+markers',
                name: modelName + ' 預測',
                line: { color: '#A23B72', width: 2, dash: 'dot' },
                marker: { size: 4 }
            });

            const layout = {
                title: modelName + ' 模型：預測 vs 實際',
                xaxis: { title: '回測年月' },
                yaxis: { title: '營收 (億元)' },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };
            Plotly.newPlot(divId, traces, layout, {responsive: true});
        }
    
    </script>
</body>
</html>