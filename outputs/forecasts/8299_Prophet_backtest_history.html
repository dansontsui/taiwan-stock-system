<!DOCTYPE html>
<html lang='zh-Hant'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>8299 互動式回測分析</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            background: #e9ecef;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .tab:hover {
            background: #dee2e6;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #667eea;
            color: #667eea;
        }
        .tab-content {
            display: none;
            padding: 30px;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
        }
        .model-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #dee2e6;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:hover {
            background: #f1f7ff;
        }
        .num {
            font-variant-numeric: tabular-nums;
        }
        .error-positive {
            color: #dc3545;
        }
        .error-negative {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>8299 互動式回測分析</h1>
            <p>所有模型的預測表現與詳細歷史</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">📊 總覽</button>
            <button class="tab" onclick="showTab('prophet')">📐 Prophet</button>
        </div>

        <!-- 總覽頁面 -->
        <div id="overview" class="tab-content active">
            <h2>📈 所有模型預測對比</h2>
            <div class="chart-container">
                <div id="comparison-chart" style="height: 600px;"></div>
            </div>

            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.00%</div>
                    <div class="stat-label">Prophet MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">Prophet 趨勢準確率</div>
                </div>
            </div>
        </div>
        <div id="prophet" class="tab-content">
            <h2>📐 Prophet 詳細分析</h2>
            <div class="model-stats">
                <div class="stat-card">
                    <div class="stat-value">0.00%</div>
                    <div class="stat-label">MAPE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0.0%</div>
                    <div class="stat-label">趨勢準確率</div>
                </div>
            </div>
            <div class="chart-container">
                <div id="prophet-chart" style="height: 500px;"></div>
            </div>
            <h3>詳細回測歷史</h3>
            <div style="max-height: 400px; overflow: auto; border: 1px solid #eee;">
                <table>
                    <thead>
                        <tr>
                            <th>期數</th>
                            <th>回測年月</th>
                            <th>預測數據</th>
                            <th>實際數據</th>
                            <th>誤差(%)</th>
                        </tr>
                    </thead>
                    <tbody id="prophet-tbody"></tbody>
                </table>
            </div>
            <script>
                (function() {
                    const rows = [{"period": 1, "test_date": "2012-12", "predicted": 2862137113.8799567, "actual": 2435207000.0, "error_pct": 17.531573861275724}, {"period": 2, "test_date": "2013-01", "predicted": 2810296962.772703, "actual": 2379656000.0, "error_pct": 18.09677376783464}, {"period": 3, "test_date": "2013-02", "predicted": 2680862238.200182, "actual": 1904292000.0, "error_pct": 40.77999793099913}, {"period": 4, "test_date": "2013-03", "predicted": 2366307849.079004, "actual": 2829897000.0, "error_pct": 16.38183831146491}, {"period": 5, "test_date": "2013-04", "predicted": 2448145670.7035694, "actual": 2655632000.0, "error_pct": 7.813067823268834}, {"period": 6, "test_date": "2013-05", "predicted": 2485046180.7565536, "actual": 3021958000.0, "error_pct": 17.767017914989104}, {"period": 7, "test_date": "2013-06", "predicted": 2641350800.078547, "actual": 2620416000.0, "error_pct": 0.7989113208951175}, {"period": 8, "test_date": "2013-07", "predicted": 2633022911.4442463, "actual": 3032704000.0, "error_pct": 13.179033910192148}, {"period": 9, "test_date": "2013-08", "predicted": 2712981048.732489, "actual": 2678439000.0, "error_pct": 1.2896335788303974}, {"period": 10, "test_date": "2013-09", "predicted": 2704155998.3105044, "actual": 2688611000.0, "error_pct": 0.578179525059759}, {"period": 11, "test_date": "2013-10", "predicted": 2702981210.9480724, "actual": 2986999000.0, "error_pct": 9.50846615790389}, {"period": 12, "test_date": "2013-11", "predicted": 2743485262.01243, "actual": 2839349000.0, "error_pct": 3.376257655806659}, {"period": 13, "test_date": "2013-12", "predicted": 2790391599.70677, "actual": 2536378000.0, "error_pct": 10.014816391987706}, {"period": 14, "test_date": "2014-01", "predicted": 2728617308.3040714, "actual": 2624079000.0, "error_pct": 3.983809492933384}, {"period": 15, "test_date": "2014-02", "predicted": 2716542087.384716, "actual": 2367984000.0, "error_pct": 14.719613282214558}, {"period": 16, "test_date": "2014-03", "predicted": 2662660334.203202, "actual": 2709271000.0, "error_pct": 1.7204135650069052}, {"period": 17, "test_date": "2014-04", "predicted": 2664659889.5333266, "actual": 2594411000.0, "error_pct": 2.7077008821395925}, {"period": 18, "test_date": "2014-05", "predicted": 2657091934.917742, "actual": 2770956000.0, "error_pct": 4.109197875471795}, {"period": 19, "test_date": "2014-06", "predicted": 2667511614.226757, "actual": 2722511000.0, "error_pct": 2.020171296764015}, {"period": 20, "test_date": "2014-07", "predicted": 2676737359.4754987, "actual": 3049473000.0, "error_pct": 12.222952638849446}, {"period": 21, "test_date": "2014-08", "predicted": 2714658084.856096, "actual": 2789293000.0, "error_pct": 2.6757646164782503}, {"period": 22, "test_date": "2014-09", "predicted": 2723397267.9487004, "actual": 2678980000.0, "error_pct": 1.657991771073335}, {"period": 23, "test_date": "2014-10", "predicted": 2720077580.717931, "actual": 3120819000.0, "error_pct": 12.840905521341329}, {"period": 24, "test_date": "2014-11", "predicted": 2781853492.4395075, "actual": 2911902000.0, "error_pct": 4.466101797398832}, {"period": 25, "test_date": "2014-12", "predicted": 2813372717.724736, "actual": 2735019000.0, "error_pct": 2.864832665686627}, {"period": 26, "test_date": "2015-01", "predicted": 2806446233.0365405, "actual": 2843731000.0, "error_pct": 1.3111214444495451}, {"period": 27, "test_date": "2015-02", "predicted": 2821419795.4856744, "actual": 2631357000.0, "error_pct": 7.222995415889002}, {"period": 28, "test_date": "2015-03", "predicted": 2789473560.322793, "actual": 2866389000.0, "error_pct": 2.683356644098445}, {"period": 29, "test_date": "2015-04", "predicted": 2808052307.090844, "actual": 2889796000.0, "error_pct": 2.8287011577687946}, {"period": 30, "test_date": "2015-05", "predicted": 2833560981.852201, "actual": 2811290000.0, "error_pct": 0.7921979536867937}, {"period": 31, "test_date": "2015-06", "predicted": 2833855752.4157114, "actual": 2741071000.0, "error_pct": 3.3849817248700016}, {"period": 32, "test_date": "2015-07", "predicted": 2823873787.7993374, "actual": 3317290000.0, "error_pct": 14.874075290392538}, {"period": 33, "test_date": "2015-08", "predicted": 2923274915.930413, "actual": 3225471000.0, "error_pct": 9.369052893967648}, {"period": 34, "test_date": "2015-09", "predicted": 2993849415.8289104, "actual": 3491055000.0, "error_pct": 14.242273014062787}, {"period": 35, "test_date": "2015-10", "predicted": 3102342176.096919, "actual": 4170476000.0, "error_pct": 25.611796444892164}, {"period": 36, "test_date": "2015-11", "predicted": 3341197942.904459, "actual": 3227037000.0, "error_pct": 3.537639726611718}, {"period": 37, "test_date": "2015-12", "predicted": 3391724631.286926, "actual": 2963140000.0, "error_pct": 14.463867089875126}, {"period": 38, "test_date": "2016-01", "predicted": 3319392899.706864, "actual": 3120529000.0, "error_pct": 6.372762429282468}, {"period": 39, "test_date": "2016-02", "predicted": 3335425526.82007, "actual": 3091855000.0, "error_pct": 7.877812084333508}, {"period": 40, "test_date": "2016-03", "predicted": 3320149406.349125, "actual": 3694002000.0, "error_pct": 10.120530353012128}, {"period": 41, "test_date": "2016-04", "predicted": 3428549071.8207216, "actual": 3835798000.0, "error_pct": 10.617058775756137}, {"period": 42, "test_date": "2016-05", "predicted": 3571469383.6284933, "actual": 3190326000.0, "error_pct": 11.946847551895742}, {"period": 43, "test_date": "2016-06", "predicted": 3538676996.963605, "actual": 3430814000.0, "error_pct": 3.143947674330492}, {"period": 44, "test_date": "2016-07", "predicted": 3562020595.5943565, "actual": 3788741000.0, "error_pct": 5.984056561418251}, {"period": 45, "test_date": "2016-08", "predicted": 3644411410.1976113, "actual": 4445990000.0, "error_pct": 18.02924859935332}, {"period": 46, "test_date": "2016-09", "predicted": 3850049712.38016, "actual": 4102626000.0, "error_pct": 6.156454125231988}, {"period": 47, "test_date": "2016-10", "predicted": 3955297653.677345, "actual": 4176802000.0, "error_pct": 5.303204373170065}, {"period": 48, "test_date": "2016-11", "predicted": 4040276429.672287, "actual": 3837687000.0, "error_pct": 5.278946137928575}, {"period": 49, "test_date": "2016-12", "predicted": 4068633482.842232, "actual": 3067342000.0, "error_pct": 32.64362053016037}, {"period": 50, "test_date": "2017-01", "predicted": 3953074756.73857, "actual": 3147077000.0, "error_pct": 25.61099575061464}, {"period": 51, "test_date": "2017-02", "predicted": 3873103491.485541, "actual": 2779274000.0, "error_pct": 39.35666262072542}, {"period": 52, "test_date": "2017-03", "predicted": 3743248962.709729, "actual": 3629516000.0, "error_pct": 3.1335572762244106}, {"period": 53, "test_date": "2017-04", "predicted": 3752748556.787559, "actual": 3356656000.0, "error_pct": 11.800212973493828}, {"period": 54, "test_date": "2017-05", "predicted": 3697106564.080857, "actual": 3492154000.0, "error_pct": 5.868944040865804}, {"period": 55, "test_date": "2017-06", "predicted": 3673176892.363026, "actual": 3643683000.0, "error_pct": 0.8094527532451682}, {"period": 56, "test_date": "2017-07", "predicted": 3685860655.567207, "actual": 3627165000.0, "error_pct": 1.6182240280551576}, {"period": 57, "test_date": "2017-08", "predicted": 3685805044.9386687, "actual": 3606489000.0, "error_pct": 2.1992593056201954}, {"period": 58, "test_date": "2017-09", "predicted": 3670744198.591549, "actual": 3939973000.0, "error_pct": 6.833265136802995}, {"period": 59, "test_date": "2017-10", "predicted": 3711448426.8031735, "actual": 3741271000.0, "error_pct": 0.7971241109458913}, {"period": 60, "test_date": "2017-11", "predicted": 3710541747.990108, "actual": 3896275000.0, "error_pct": 4.766944119957972}, {"period": 61, "test_date": "2017-12", "predicted": 3755653153.18103, "actual": 3005226000.0, "error_pct": 24.970739411313158}, {"period": 62, "test_date": "2018-01", "predicted": 3625909401.836256, "actual": 3065076000.0, "error_pct": 18.29753656471344}, {"period": 63, "test_date": "2018-02", "predicted": 3519269297.21108, "actual": 2731663000.0, "error_pct": 28.832483992757517}, {"period": 64, "test_date": "2018-03", "predicted": 3359545988.3350816, "actual": 3502814000.0, "error_pct": 4.09008333485359}, {"period": 65, "test_date": "2018-04", "predicted": 3363776187.3049417, "actual": 3518011000.0, "error_pct": 4.384148107980855}, {"period": 66, "test_date": "2018-05", "predicted": 3370611113.5917506, "actual": 3459047000.0, "error_pct": 2.5566546626353843}, {"period": 67, "test_date": "2018-06", "predicted": 3365823681.4176664, "actual": 3352088000.0, "error_pct": 0.4097649410655817}, {"period": 68, "test_date": "2018-07", "predicted": 3335110087.041293, "actual": 3569800000.0, "error_pct": 6.574315450689307}, {"period": 69, "test_date": "2018-08", "predicted": 3357150524.6170487, "actual": 3905980000.0, "error_pct": 14.05100577532274}, {"period": 70, "test_date": "2018-09", "predicted": 3436858965.387345, "actual": 3561053000.0, "error_pct": 3.48756490320855}, {"period": 71, "test_date": "2018-10", "predicted": 3440196976.1223707, "actual": 3606644000.0, "error_pct": 4.615011181520252}, {"period": 72, "test_date": "2018-11", "predicted": 3466961487.531396, "actual": 3554055000.0, "error_pct": 2.4505392423191}, {"period": 73, "test_date": "2018-12", "predicted": 3481270024.111753, "actual": 2961874000.0, "error_pct": 17.53606075450046}, {"period": 74, "test_date": "2019-01", "predicted": 3410631609.0495806, "actual": 3358464000.0, "error_pct": 1.5533175001899848}, {"period": 75, "test_date": "2019-02", "predicted": 3399589371.198733, "actual": 2710307000.0, "error_pct": 25.431892815047625}, {"period": 76, "test_date": "2019-03", "predicted": 3312529570.99132, "actual": 3274245000.0, "error_pct": 1.1692640896243152}, {"period": 77, "test_date": "2019-04", "predicted": 3282547364.953768, "actual": 3084400000.0, "error_pct": 6.424178606982485}, {"period": 78, "test_date": "2019-05", "predicted": 3258641185.351947, "actual": 3355208000.0, "error_pct": 2.878117083890273}, {"period": 79, "test_date": "2019-06", "predicted": 3258805304.4712424, "actual": 3343520000.0, "error_pct": 2.533697885125783}, {"period": 80, "test_date": "2019-07", "predicted": 3243421403.4174776, "actual": 4062819000.0, "error_pct": 20.168203323419583}, {"period": 81, "test_date": "2019-08", "predicted": 3331699854.0563912, "actual": 4272747000.0, "error_pct": 22.0244059838696}, {"period": 82, "test_date": "2019-09", "predicted": 3427268775.2702265, "actual": 4058337000.0, "error_pct": 15.549921673083666}, {"period": 83, "test_date": "2019-10", "predicted": 3476328479.864067, "actual": 4697324000.0, "error_pct": 25.993427750266594}, {"period": 84, "test_date": "2019-11", "predicted": 3635832621.1276665, "actual": 4380889000.0, "error_pct": 17.00696773810826}, {"period": 85, "test_date": "2019-12", "predicted": 3785160676.544483, "actual": 4095181000.0, "error_pct": 7.57036925731773}, {"period": 86, "test_date": "2020-01", "predicted": 3843644864.971906, "actual": 3325942000.0, "error_pct": 15.565601113065297}, {"period": 87, "test_date": "2020-02", "predicted": 3779417022.375032, "actual": 4001968000.0, "error_pct": 5.561038409726605}, {"period": 88, "test_date": "2020-03", "predicted": 3867538678.835001, "actual": 5538793000.0, "error_pct": 30.17361943594929}, {"period": 89, "test_date": "2020-04", "predicted": 4146884633.1844473, "actual": 3579202000.0, "error_pct": 15.86059219860872}, {"period": 90, "test_date": "2020-05", "predicted": 4110558871.097817, "actual": 3905092000.0, "error_pct": 5.261511664714083}, {"period": 91, "test_date": "2020-06", "predicted": 4125262526.3771296, "actual": 3370555000.0, "error_pct": 22.391194517731638}, {"period": 92, "test_date": "2020-07", "predicted": 4037006267.132679, "actual": 3849067000.0, "error_pct": 4.882722673642183}, {"period": 93, "test_date": "2020-08", "predicted": 4049098617.06078, "actual": 3743807000.0, "error_pct": 8.15457680005353}, {"period": 94, "test_date": "2020-09", "predicted": 4037106793.321852, "actual": 4341123000.0, "error_pct": 7.003169610217168}, {"period": 95, "test_date": "2020-10", "predicted": 4116293355.855648, "actual": 4447850000.0, "error_pct": 7.454312626198105}, {"period": 96, "test_date": "2020-11", "predicted": 4173108753.173668, "actual": 4218291000.0, "error_pct": 1.0711031274592504}, {"period": 97, "test_date": "2020-12", "predicted": 4211602650.131391, "actual": 4174832000.0, "error_pct": 0.880769576629456}, {"period": 98, "test_date": "2021-01", "predicted": 4249837076.4974976, "actual": 4060743000.0, "error_pct": 4.656637381323998}, {"period": 99, "test_date": "2021-02", "predicted": 4263442844.7282314, "actual": 3654613000.0, "error_pct": 16.659215209058537}, {"period": 100, "test_date": "2021-03", "predicted": 4224054528.560138, "actual": 5172594000.0, "error_pct": 18.337790892535967}, {"period": 101, "test_date": "2021-04", "predicted": 4357799011.381448, "actual": 5090578000.0, "error_pct": 14.39480916741777}, {"period": 102, "test_date": "2021-05", "predicted": 4492417514.268999, "actual": 5696048000.0, "error_pct": 21.13097512048706}, {"period": 103, "test_date": "2021-06", "predicted": 4707941800.992223, "actual": 5123350000.0, "error_pct": 8.108136258654538}, {"period": 104, "test_date": "2021-07", "predicted": 4790103940.020356, "actual": 5482184000.0, "error_pct": 12.624166937476812}, {"period": 105, "test_date": "2021-08", "predicted": 4935348392.64771, "actual": 5706563000.0, "error_pct": 13.514520164804807}, {"period": 106, "test_date": "2021-09", "predicted": 5080320866.851143, "actual": 5737799000.0, "error_pct": 11.4587167160937}, {"period": 107, "test_date": "2021-10", "predicted": 5208581555.785235, "actual": 6036781000.0, "error_pct": 13.71922294704354}, {"period": 108, "test_date": "2021-11", "predicted": 5371571918.795281, "actual": 5802942000.0, "error_pct": 7.433644541074486}, {"period": 109, "test_date": "2021-12", "predicted": 5490071899.412516, "actual": 4992997000.0, "error_pct": 9.955441579726878}, {"period": 110, "test_date": "2022-01", "predicted": 5500805146.245872, "actual": 5418890000.0, "error_pct": 1.5116591450623935}, {"period": 111, "test_date": "2022-02", "predicted": 5558095218.096278, "actual": 5307336000.0, "error_pct": 4.724766212206617}, {"period": 112, "test_date": "2022-03", "predicted": 5582664355.326903, "actual": 6379633000.0, "error_pct": 12.492390152742276}, {"period": 113, "test_date": "2022-04", "predicted": 5740378746.925825, "actual": 5901725000.0, "error_pct": 2.73388294226137}, {"period": 114, "test_date": "2022-05", "predicted": 5837947008.429957, "actual": 5099437000.0, "error_pct": 14.482187120459717}, {"period": 115, "test_date": "2022-06", "predicted": 5829086455.593093, "actual": 5284253000.0, "error_pct": 10.310510408814508}, {"period": 116, "test_date": "2022-07", "predicted": 5822580415.462085, "actual": 5342363000.0, "error_pct": 8.988857841784334}, {"period": 117, "test_date": "2022-08", "predicted": 5829534988.924162, "actual": 4423361000.0, "error_pct": 31.78971802039585}, {"period": 118, "test_date": "2022-09", "predicted": 5767953847.807585, "actual": 4808884000.0, "error_pct": 19.943709347274435}, {"period": 119, "test_date": "2022-10", "predicted": 5740674711.310535, "actual": 4205901000.0, "error_pct": 36.49096142088308}, {"period": 120, "test_date": "2022-11", "predicted": 5645098618.695519, "actual": 4082304000.0, "error_pct": 38.28217150647082}, {"period": 121, "test_date": "2022-12", "predicted": 5568605108.04616, "actual": 4002055000.0, "error_pct": 39.14364265474012}, {"period": 122, "test_date": "2023-01", "predicted": 5486278406.458013, "actual": 2878167000.0, "error_pct": 90.61709784241194}, {"period": 123, "test_date": "2023-02", "predicted": 5280211215.149942, "actual": 3274873000.0, "error_pct": 61.23407579927351}, {"period": 124, "test_date": "2023-03", "predicted": 5111253938.077062, "actual": 3925381000.0, "error_pct": 30.21039073855663}, {"period": 125, "test_date": "2023-04", "predicted": 4999558770.257898, "actual": 3366959000.0, "error_pct": 48.48885211426389}, {"period": 126, "test_date": "2023-05", "predicted": 4835184636.142783, "actual": 3201684000.0, "error_pct": 51.02004558047525}, {"period": 127, "test_date": "2023-06", "predicted": 4623976272.571793, "actual": 3438001000.0, "error_pct": 34.49607119287611}, {"period": 128, "test_date": "2023-07", "predicted": 4474629382.049477, "actual": 3394299000.0, "error_pct": 31.82779071759667}, {"period": 129, "test_date": "2023-08", "predicted": 4246462519.1404543, "actual": 3990403000.0, "error_pct": 6.416883686696664}, {"period": 130, "test_date": "2023-09", "predicted": 4142994859.386459, "actual": 5003863000.0, "error_pct": 17.204070947057126}, {"period": 131, "test_date": "2023-10", "predicted": 4220976475.796229, "actual": 5158905000.0, "error_pct": 18.18076751178344}, {"period": 132, "test_date": "2023-11", "predicted": 4265667692.1828456, "actual": 5407270000.0, "error_pct": 21.11235998604017}, {"period": 133, "test_date": "2023-12", "predicted": 4333913747.417105, "actual": 5181825000.0, "error_pct": 16.363178080751382}, {"period": 134, "test_date": "2024-01", "predicted": 4364115301.03074, "actual": 5086003000.0, "error_pct": 14.19361528039327}, {"period": 135, "test_date": "2024-02", "predicted": 4343401409.120511, "actual": 4664908000.0, "error_pct": 6.892024255987233}, {"period": 136, "test_date": "2024-03", "predicted": 4377690145.335135, "actual": 6774966000.0, "error_pct": 35.38432303077042}, {"period": 137, "test_date": "2024-04", "predicted": 4554146729.596251, "actual": 5156193000.0, "error_pct": 11.676177955397508}, {"period": 138, "test_date": "2024-05", "predicted": 4581137546.131709, "actual": 5377566000.0, "error_pct": 14.810203238199046}, {"period": 139, "test_date": "2024-06", "predicted": 4598941806.435019, "actual": 5361009000.0, "error_pct": 14.214995601853708}, {"period": 140, "test_date": "2024-07", "predicted": 4640518021.40103, "actual": 4706092000.0, "error_pct": 1.393384969927711}, {"period": 141, "test_date": "2024-08", "predicted": 4663128860.50432, "actual": 4805588000.0, "error_pct": 2.9644476283792924}, {"period": 142, "test_date": "2024-09", "predicted": 4618752019.337212, "actual": 4430879000.0, "error_pct": 4.240084627389094}, {"period": 143, "test_date": "2024-10", "predicted": 4603256780.96153, "actual": 3717027000.0, "error_pct": 23.84243592961605}, {"period": 144, "test_date": "2024-11", "predicted": 4471800887.624967, "actual": 4333904000.0, "error_pct": 3.181816847465164}, {"period": 145, "test_date": "2024-12", "predicted": 4477510130.512827, "actual": 4521378000.0, "error_pct": 0.9702322939416496}, {"period": 146, "test_date": "2025-01", "predicted": 4472601440.216088, "actual": 3613390000.0, "error_pct": 23.77854148641825}, {"period": 147, "test_date": "2025-02", "predicted": 4377533298.066528, "actual": 4527416000.0, "error_pct": 3.310557323061801}, {"period": 148, "test_date": "2025-03", "predicted": 4364130015.539334, "actual": 5697759000.0, "error_pct": 23.406202060505997}, {"period": 149, "test_date": "2025-04", "predicted": 4473342617.909473, "actual": 6002833000.0, "error_pct": 25.47947580901429}, {"period": 150, "test_date": "2025-05", "predicted": 4609807146.87444, "actual": 5689559000.0, "error_pct": 18.977777594459603}, {"period": 151, "test_date": "2025-06", "predicted": 4696973134.046438, "actual": 6197679000.0, "error_pct": 24.213997949128405}];
                    const tbody = document.getElementById('prophet-tbody');
                    rows.forEach(r => {
                        const tr = document.createElement('tr');
                        function td(v) { const d = document.createElement('td'); d.textContent = (typeof v==='number')? v.toLocaleString(): v; d.title = v; d.className='num'; return d; }
                        tr.appendChild(td(r.period));
                        tr.appendChild(td(r.test_date));
                        tr.appendChild(td(r.predicted));
                        tr.appendChild(td(r.actual));
                        const e = td(r.error_pct);
                        e.className += (r.error_pct>=0 ? ' error-positive' : ' error-negative');
                        tr.appendChild(e);
                        tbody.appendChild(tr);
                    });
                })()
            </script>
        </div>
    
    </div>

    <script>
        // 圖表數據
        const chartData = {"periods": ["2012-12", "2013-01", "2013-02", "2013-03", "2013-04", "2013-05", "2013-06", "2013-07", "2013-08", "2013-09", "2013-10", "2013-11", "2013-12", "2014-01", "2014-02", "2014-03", "2014-04", "2014-05", "2014-06", "2014-07", "2014-08", "2014-09", "2014-10", "2014-11", "2014-12", "2015-01", "2015-02", "2015-03", "2015-04", "2015-05", "2015-06", "2015-07", "2015-08", "2015-09", "2015-10", "2015-11", "2015-12", "2016-01", "2016-02", "2016-03", "2016-04", "2016-05", "2016-06", "2016-07", "2016-08", "2016-09", "2016-10", "2016-11", "2016-12", "2017-01", "2017-02", "2017-03", "2017-04", "2017-05", "2017-06", "2017-07", "2017-08", "2017-09", "2017-10", "2017-11", "2017-12", "2018-01", "2018-02", "2018-03", "2018-04", "2018-05", "2018-06", "2018-07", "2018-08", "2018-09", "2018-10", "2018-11", "2018-12", "2019-01", "2019-02", "2019-03", "2019-04", "2019-05", "2019-06", "2019-07", "2019-08", "2019-09", "2019-10", "2019-11", "2019-12", "2020-01", "2020-02", "2020-03", "2020-04", "2020-05", "2020-06", "2020-07", "2020-08", "2020-09", "2020-10", "2020-11", "2020-12", "2021-01", "2021-02", "2021-03", "2021-04", "2021-05", "2021-06", "2021-07", "2021-08", "2021-09", "2021-10", "2021-11", "2021-12", "2022-01", "2022-02", "2022-03", "2022-04", "2022-05", "2022-06", "2022-07", "2022-08", "2022-09", "2022-10", "2022-11", "2022-12", "2023-01", "2023-02", "2023-03", "2023-04", "2023-05", "2023-06", "2023-07", "2023-08", "2023-09", "2023-10", "2023-11", "2023-12", "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06", "2024-07", "2024-08", "2024-09", "2024-10", "2024-11", "2024-12", "2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06"], "actual": [2435207000.0, 2379656000.0, 1904292000.0, 2829897000.0, 2655632000.0, 3021958000.0, 2620416000.0, 3032704000.0, 2678439000.0, 2688611000.0, 2986999000.0, 2839349000.0, 2536378000.0, 2624079000.0, 2367984000.0, 2709271000.0, 2594411000.0, 2770956000.0, 2722511000.0, 3049473000.0, 2789293000.0, 2678980000.0, 3120819000.0, 2911902000.0, 2735019000.0, 2843731000.0, 2631357000.0, 2866389000.0, 2889796000.0, 2811290000.0, 2741071000.0, 3317290000.0, 3225471000.0, 3491055000.0, 4170476000.0, 3227037000.0, 2963140000.0, 3120529000.0, 3091855000.0, 3694002000.0, 3835798000.0, 3190326000.0, 3430814000.0, 3788741000.0, 4445990000.0, 4102626000.0, 4176802000.0, 3837687000.0, 3067342000.0, 3147077000.0, 2779274000.0, 3629516000.0, 3356656000.0, 3492154000.0, 3643683000.0, 3627165000.0, 3606489000.0, 3939973000.0, 3741271000.0, 3896275000.0, 3005226000.0, 3065076000.0, 2731663000.0, 3502814000.0, 3518011000.0, 3459047000.0, 3352088000.0, 3569800000.0, 3905980000.0, 3561053000.0, 3606644000.0, 3554055000.0, 2961874000.0, 3358464000.0, 2710307000.0, 3274245000.0, 3084400000.0, 3355208000.0, 3343520000.0, 4062819000.0, 4272747000.0, 4058337000.0, 4697324000.0, 4380889000.0, 4095181000.0, 3325942000.0, 4001968000.0, 5538793000.0, 3579202000.0, 3905092000.0, 3370555000.0, 3849067000.0, 3743807000.0, 4341123000.0, 4447850000.0, 4218291000.0, 4174832000.0, 4060743000.0, 3654613000.0, 5172594000.0, 5090578000.0, 5696048000.0, 5123350000.0, 5482184000.0, 5706563000.0, 5737799000.0, 6036781000.0, 5802942000.0, 4992997000.0, 5418890000.0, 5307336000.0, 6379633000.0, 5901725000.0, 5099437000.0, 5284253000.0, 5342363000.0, 4423361000.0, 4808884000.0, 4205901000.0, 4082304000.0, 4002055000.0, 2878167000.0, 3274873000.0, 3925381000.0, 3366959000.0, 3201684000.0, 3438001000.0, 3394299000.0, 3990403000.0, 5003863000.0, 5158905000.0, 5407270000.0, 5181825000.0, 5086003000.0, 4664908000.0, 6774966000.0, 5156193000.0, 5377566000.0, 5361009000.0, 4706092000.0, 4805588000.0, 4430879000.0, 3717027000.0, 4333904000.0, 4521378000.0, 3613390000.0, 4527416000.0, 5697759000.0, 6002833000.0, 5689559000.0, 6197679000.0], "models": {"Prophet": {"predictions": [2862137113.8799567, 2810296962.772703, 2680862238.200182, 2366307849.079004, 2448145670.7035694, 2485046180.7565536, 2641350800.078547, 2633022911.4442463, 2712981048.732489, 2704155998.3105044, 2702981210.9480724, 2743485262.01243, 2790391599.70677, 2728617308.3040714, 2716542087.384716, 2662660334.203202, 2664659889.5333266, 2657091934.917742, 2667511614.226757, 2676737359.4754987, 2714658084.856096, 2723397267.9487004, 2720077580.717931, 2781853492.4395075, 2813372717.724736, 2806446233.0365405, 2821419795.4856744, 2789473560.322793, 2808052307.090844, 2833560981.852201, 2833855752.4157114, 2823873787.7993374, 2923274915.930413, 2993849415.8289104, 3102342176.096919, 3341197942.904459, 3391724631.286926, 3319392899.706864, 3335425526.82007, 3320149406.349125, 3428549071.8207216, 3571469383.6284933, 3538676996.963605, 3562020595.5943565, 3644411410.1976113, 3850049712.38016, 3955297653.677345, 4040276429.672287, 4068633482.842232, 3953074756.73857, 3873103491.485541, 3743248962.709729, 3752748556.787559, 3697106564.080857, 3673176892.363026, 3685860655.567207, 3685805044.9386687, 3670744198.591549, 3711448426.8031735, 3710541747.990108, 3755653153.18103, 3625909401.836256, 3519269297.21108, 3359545988.3350816, 3363776187.3049417, 3370611113.5917506, 3365823681.4176664, 3335110087.041293, 3357150524.6170487, 3436858965.387345, 3440196976.1223707, 3466961487.531396, 3481270024.111753, 3410631609.0495806, 3399589371.198733, 3312529570.99132, 3282547364.953768, 3258641185.351947, 3258805304.4712424, 3243421403.4174776, 3331699854.0563912, 3427268775.2702265, 3476328479.864067, 3635832621.1276665, 3785160676.544483, 3843644864.971906, 3779417022.375032, 3867538678.835001, 4146884633.1844473, 4110558871.097817, 4125262526.3771296, 4037006267.132679, 4049098617.06078, 4037106793.321852, 4116293355.855648, 4173108753.173668, 4211602650.131391, 4249837076.4974976, 4263442844.7282314, 4224054528.560138, 4357799011.381448, 4492417514.268999, 4707941800.992223, 4790103940.020356, 4935348392.64771, 5080320866.851143, 5208581555.785235, 5371571918.795281, 5490071899.412516, 5500805146.245872, 5558095218.096278, 5582664355.326903, 5740378746.925825, 5837947008.429957, 5829086455.593093, 5822580415.462085, 5829534988.924162, 5767953847.807585, 5740674711.310535, 5645098618.695519, 5568605108.04616, 5486278406.458013, 5280211215.149942, 5111253938.077062, 4999558770.257898, 4835184636.142783, 4623976272.571793, 4474629382.049477, 4246462519.1404543, 4142994859.386459, 4220976475.796229, 4265667692.1828456, 4333913747.417105, 4364115301.03074, 4343401409.120511, 4377690145.335135, 4554146729.596251, 4581137546.131709, 4598941806.435019, 4640518021.40103, 4663128860.50432, 4618752019.337212, 4603256780.96153, 4471800887.624967, 4477510130.512827, 4472601440.216088, 4377533298.066528, 4364130015.539334, 4473342617.909473, 4609807146.87444, 4696973134.046438]}}};

        // 初始化圖表
        initializeCharts();

        function showTab(tabName) {
            // 隱藏所有內容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 顯示選中的內容
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // 重新渲染圖表（Plotly需要）
            setTimeout(() => {
                Plotly.Plots.resize();
            }, 100);
        }

        function initializeCharts() {
            // 總覽對比圖
            createComparisonChart();

            // 各模型詳細圖
            createModelChart('Prophet');
        }

        function createComparisonChart() {
            const traces = [];

            // 實際值（只需要一條線）
            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            // 各模型預測值
            const colors = ['#A23B72', '#F18F01', '#C73E1D', '#7209B7'];
            let colorIndex = 0;

            Object.keys(chartData.models).forEach(modelName => {
                const modelData = chartData.models[modelName];
                traces.push({
                    x: chartData.periods,
                    y: modelData.predictions,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `${modelName} 預測`,
                    line: { color: colors[colorIndex % colors.length], width: 2, dash: 'dot' },
                    marker: { size: 4 }
                });
                colorIndex++;
            });

            const layout = {
                title: '所有模型預測對比',
                xaxis: { title: '回測期數' },
                yaxis: {
                    title: '營收 (億元)',
                    tickformat: '.1f'
                },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };

            Plotly.newPlot('comparison-chart', traces, layout, {responsive: true});
        }

        
        function createModelChart(modelName) {
            const divId = modelName.toLowerCase() + '-chart';
            const preds = chartData.models[modelName]?.predictions || [];
            const traces = [];

            if (chartData.actual && chartData.actual.length > 0) {
                traces.push({
                    x: chartData.periods,
                    y: chartData.actual.map(v => v/1e8),
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: '實際值',
                    line: { color: '#2E86AB', width: 3 },
                    marker: { size: 6 }
                });
            }

            traces.push({
                x: chartData.periods,
                y: preds.map(v => v/1e8),
                type: 'scatter',
                mode: 'lines+markers',
                name: modelName + ' 預測',
                line: { color: '#A23B72', width: 2, dash: 'dot' },
                marker: { size: 4 }
            });

            const layout = {
                title: modelName + ' 模型：預測 vs 實際',
                xaxis: { title: '回測年月' },
                yaxis: { title: '營收 (億元)' },
                hovermode: 'x unified',
                showlegend: true,
                legend: { x: 0, y: 1 }
            };
            Plotly.newPlot(divId, traces, layout, {responsive: true});
        }
    
    </script>
</body>
</html>