# 🔐 環境變數設定說明

## 📋 概述

為了保護 API Token 等敏感資訊，系統已設定使用環境變數來管理配置。

## 🚀 快速設定

### 1. 安裝依賴套件
```bash
pip install python-dotenv
```

### 2. 設定環境變數檔案
系統已自動創建 `.env` 檔案，包含以下配置：

```env
# FinMind API Token
FINMIND_API_TOKEN=your_actual_token_here

# 資料庫配置
DATABASE_PATH=data/taiwan_stock.db

# API配置
FINMIND_API_URL=https://api.finmindtrade.com/api/v4/data

# 系統配置
DEBUG=False
LOG_LEVEL=INFO
```

### 3. 驗證設定
```bash
python test_env.py
```

## 🔒 安全性

### ✅ 已保護的檔案
- `.env` - 已加入 `.gitignore`，不會被提交到 Git
- API Token 不會出現在程式碼中

### ✅ 已更新的檔案
- `config.py` - 使用 `os.getenv()` 讀取環境變數
- `simple_collect.py` - 使用環境變數載入 API Token

## 📁 檔案結構

```
taiwan-stock-system/
├── .env                    # 環境變數檔案 (不會提交到Git)
├── .env.example           # 環境變數範本
├── .gitignore             # 已包含 .env
├── config.py              # 已更新使用環境變數
├── simple_collect.py      # 已更新使用環境變數
└── test_env.py           # 環境變數測試腳本
```

## 🛠️ 使用方式

### 在程式中使用環境變數

```python
import os
from dotenv import load_dotenv

# 載入 .env 檔案
load_dotenv()

# 讀取環境變數
api_token = os.getenv('FINMIND_API_TOKEN', '')
database_path = os.getenv('DATABASE_PATH', 'data/taiwan_stock.db')
```

### 在 config.py 中使用

```python
class Config:
    # 從環境變數讀取，如果沒有則使用預設值
    FINMIND_API_TOKEN = os.getenv('FINMIND_API_TOKEN', '')
    DATABASE_PATH = os.path.join(BASE_DIR, os.getenv('DATABASE_PATH', 'data/taiwan_stock.db'))
```

## 🔄 團隊協作

### 新成員設定步驟

1. **複製範本檔案**
   ```bash
   copy .env.example .env
   ```

2. **編輯 .env 檔案**
   - 填入自己的 FinMind API Token
   - 調整其他配置（如需要）

3. **驗證設定**
   ```bash
   python test_env.py
   ```

### 注意事項

- ❌ **絕對不要** 將 `.env` 檔案提交到 Git
- ✅ **務必** 將 `.env.example` 保持更新
- ✅ **建議** 定期更換 API Token

## 🧪 測試結果

執行 `python test_env.py` 應該看到：

```
🔍 測試環境變數設定
==================================================
📋 環境變數檢查:
✅ FINMIND_API_TOKEN: eyJ0eXAiOi...wHJkR9Ibmk
✅ DATABASE_PATH: data/taiwan_stock.db
✅ FINMIND_API_URL: https://api.finmindtrade.com/api/v4/data
✅ DEBUG: False
✅ LOG_LEVEL: INFO

🧪 測試 config.py 載入:
✅ FINMIND_API_TOKEN: 已設定
✅ FINMIND_API_URL: https://api.finmindtrade.com/api/v4/data
✅ DATABASE_PATH: G:\WorkFolder\taiwan-stock-system\data\taiwan_stock.db

🧪 測試 simple_collect.py 載入:
✅ API_TOKEN: 已設定
✅ DATABASE_PATH: data/taiwan_stock.db
```

## 🎯 優點

1. **安全性** - API Token 不會出現在程式碼中
2. **靈活性** - 不同環境可以使用不同配置
3. **團隊協作** - 每個人可以有自己的配置
4. **版本控制** - 敏感資訊不會被提交到 Git

## 🚨 故障排除

### 問題：找不到環境變數
**解決方案：**
1. 確認 `.env` 檔案存在
2. 確認檔案內容格式正確（沒有多餘空格）
3. 確認已安裝 `python-dotenv`

### 問題：API Token 無效
**解決方案：**
1. 檢查 FinMind 官網確認 Token 是否有效
2. 確認 `.env` 檔案中的 Token 沒有多餘的引號或空格

### 問題：程式找不到 dotenv 模組
**解決方案：**
```bash
pip install python-dotenv
```

## 🎉 完成！

現在您的 API Token 已經安全地隱藏在環境變數中，不會被意外提交到版本控制系統！
