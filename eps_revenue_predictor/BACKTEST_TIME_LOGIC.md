# 🔍 回測時間邏輯說明

## 📅 **回測時間對應關係**

### **重要說明**: 目標月份 = 預測的月份 = 實際營收的月份

| 期數 | 目標月份 | 預測情境 | 實際營收對應月份 | 說明 |
|------|----------|----------|------------------|------|
| 1 | 2024-12 | 在2024年11月底預測12月營收 | 2024年12月 | 預測12月，實際也是12月 |
| 2 | 2025-01 | 在2024年12月底預測1月營收 | 2025年1月 | 預測1月，實際也是1月 |
| 3 | 2025-02 | 在2025年1月底預測2月營收 | 2025年2月 | 預測2月，實際也是2月 |

## 🎯 **回測邏輯詳解**

### **第1期回測範例**
```
📊 回測時間點: 2024年11月30日
🎯 預測目標: 2024年12月營收
📈 使用資料: 2024年1月~11月的歷史營收
💰 預測結果: 41.7億
📋 實際結果: 43.3億 (2024年12月的真實營收)
✅ 對比: 預測12月 vs 實際12月 (同一個月)
```

### **第2期回測範例**
```
📊 回測時間點: 2024年12月31日
🎯 預測目標: 2025年1月營收
📈 使用資料: 2024年2月~12月的歷史營收
💰 預測結果: 43.7億
📋 實際結果: 45.2億 (2025年1月的真實營收)
✅ 對比: 預測1月 vs 實際1月 (同一個月)
```

## 📊 **表格欄位說明**

| 欄位名稱 | 說明 | 範例 |
|----------|------|------|
| 期數 | 回測的第幾期 | 1, 2, 3... |
| 目標月份 | 預測的目標月份 | 2024-12, 2025-01 |
| 預測營收 | AI預測的營收金額 | 41.7億 |
| 實際營收 | 該月份的真實營收 | 43.3億 |
| 預測成長率 | 預測的月成長率 | -3.7% |
| 實際成長率 | 實際的月成長率 | 16.6% |
| 方向正確 | 成長方向是否預測正確 | ✅/❌ |
| MAPE | 平均絕對百分比誤差 | 3.7% |

## 🔄 **滾動窗口回測**

### **資料使用邏輯**
```
期數1 (預測2024-12):
  訓練資料: 2024-01 ~ 2024-11 ✅
  預測目標: 2024-12
  實際對比: 2024-12真實營收

期數2 (預測2025-01):
  訓練資料: 2024-02 ~ 2024-12 ✅ (向前滾動)
  預測目標: 2025-01
  實際對比: 2025-01真實營收

期數3 (預測2025-02):
  訓練資料: 2024-03 ~ 2025-01 ✅ (繼續滾動)
  預測目標: 2025-02
  實際對比: 2025-02真實營收
```

## ⚠️ **常見誤解**

### **❌ 錯誤理解**
- 以為目標月份和實際營收是不同月份
- 以為顯示的日期格式有問題

### **✅ 正確理解**
- 目標月份就是要預測的月份
- 實際營收就是該月份的真實營收
- 兩者是同一個月份的預測vs實際對比

## 🎯 **回測的核心價值**

### **驗證預測準確度**
- 模擬歷史時間點的預測情境
- 只使用當時可獲得的資料
- 與真實結果進行對比

### **避免未來函數**
- 絕不使用未來資料進行預測
- 嚴格按照時間順序進行回測
- 確保回測結果的可信度

## 📈 **實際應用範例**

假設現在是2025年8月，我們要回測2025年7月的預測：

```
🕐 回測情境: 2025年6月30日
📊 可用資料: 2024年7月 ~ 2025年6月
🎯 預測目標: 2025年7月營收
💰 AI預測: 64.8億
📋 實際結果: 62.0億 (2025年7月真實營收)
📊 準確度: MAPE = 4.5%
```

**這就是回測的邏輯：在過去的時間點，用當時的資料，預測未來一個月，然後與真實結果對比。**

## 🎉 **總結**

**目標月份 = 預測月份 = 實際營收月份**

回測系統模擬的是：
1. 在某個歷史時間點
2. 使用當時可獲得的資料
3. 預測下個月的營收
4. 與該月的真實營收對比

這樣才能真實評估預測模型的歷史表現！
